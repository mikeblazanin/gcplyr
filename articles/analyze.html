<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="gcplyr">
<title>Analyzing data • gcplyr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Analyzing data">
<meta property="og:description" content="gcplyr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">gcplyr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.12.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/gcplyr.html">Get started</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/gcplyr.html">Introduction</a>
    <a class="dropdown-item" href="../articles/import_transform.html">Importing and transforming data</a>
    <a class="dropdown-item" href="../articles/incorporate_designs.html">Incorporating design information</a>
    <a class="dropdown-item" href="../articles/preprocess_plot.html">Pre-processing and plotting data</a>
    <a class="dropdown-item" href="../articles/process.html">Processing data</a>
    <a class="dropdown-item" href="../articles/analyze.html">Analyzing data</a>
    <a class="dropdown-item" href="../articles/noise.html">Dealing with noise</a>
    <a class="dropdown-item" href="../articles/conclusion.html">Statistics, merging other data, and other resources</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/mikeblazanin/gcplyr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Analyzing data</h1>
                        <h4 data-toc-skip class="author">Mike
Blazanin</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mikeblazanin/gcplyr/blob/HEAD/vignettes/analyze.Rmd" class="external-link"><code>vignettes/analyze.Rmd</code></a></small>
      <div class="d-none name"><code>analyze.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="where-are-we-so-far">Where are we so far?<a class="anchor" aria-label="anchor" href="#where-are-we-so-far"></a>
</h2>
<ol style="list-style-type: decimal">
<li>Introduction: <code><a href="../articles/gcplyr.html">vignette("gcplyr")</a></code>
</li>
<li>Importing and transforming data:
<code><a href="../articles/import_transform.html">vignette("import_transform")</a></code>
</li>
<li>Incorporating design information:
<code><a href="../articles/incorporate_designs.html">vignette("incorporate_designs")</a></code>
</li>
<li>Pre-processing and plotting your data:
<code><a href="../articles/preprocess_plot.html">vignette("preprocess_plot")</a></code>
</li>
<li>Processing your data: <code><a href="../articles/process.html">vignette("process")</a></code>
</li>
<li>
<strong>Analyzing your data:</strong>
<code><a href="../articles/analyze.html">vignette("analyze")</a></code>
</li>
<li>Dealing with noise: <code><a href="../articles/noise.html">vignette("noise")</a></code>
</li>
<li>Statistics, merging other data, and other resources:
<code><a href="../articles/conclusion.html">vignette("conclusion")</a></code>
</li>
</ol>
<p>So far, we’ve imported and transformed our measures, combined them
with our design information, pre-processed, processed, and plotted our
data. Now we’re going to analyze our data by summarizing our growth
curves into a number of metrics.</p>
<p>If you haven’t already, load the necessary packages.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mikeblazanin.github.io/gcplyr/">gcplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; ## </span></span>
<span><span class="co">#&gt; ## gcplyr (Version 0.12.3, Build Date: 2023-01-30)</span></span>
<span><span class="co">#&gt; ## See http://github.com/mikeblazanin/gcplyr for additional documentation</span></span>
<span><span class="co">#&gt; ## Please cite software as:</span></span>
<span><span class="co">#&gt; ##   Blazanin, Michael. 2023. 'gcplyr: manipulate and analyze growth</span></span>
<span><span class="co">#&gt; ##   curve data.' R package version 0.12.3</span></span>
<span><span class="co">#&gt; ##</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#This code was previously explained</span></span>
<span><span class="co">#Here we're re-running it so it's available for us to work with</span></span>
<span><span class="va">example_tidydata</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/trans_wide_to_tidy.html">trans_wide_to_tidy</a></span><span class="op">(</span><span class="va">example_widedata_noiseless</span>,</span>
<span>                                       id_cols <span class="op">=</span> <span class="st">"Time"</span><span class="op">)</span></span>
<span><span class="va">example_design</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_design.html">make_design</a></span><span class="op">(</span></span>
<span>  pattern_split <span class="op">=</span> <span class="st">","</span>, nrows <span class="op">=</span> <span class="fl">8</span>, ncols <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  <span class="st">"Bacteria_strain"</span> <span class="op">=</span> <span class="fu"><a href="../reference/make_designpattern.html">make_designpattern</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Strain"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">48</span><span class="op">)</span>,</span>
<span>    rows <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">8</span>, cols <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, pattern <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">48</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  <span class="st">"Bacteria_strain"</span> <span class="op">=</span> <span class="fu"><a href="../reference/make_designpattern.html">make_designpattern</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Strain"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">48</span><span class="op">)</span>,</span>
<span>    rows <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">8</span>, cols <span class="op">=</span> <span class="fl">7</span><span class="op">:</span><span class="fl">12</span>, pattern <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">48</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  <span class="st">"Phage"</span> <span class="op">=</span> <span class="fu"><a href="../reference/make_designpattern.html">make_designpattern</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"No Phage"</span><span class="op">)</span>, rows <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">8</span>, cols <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, pattern <span class="op">=</span> <span class="st">"1"</span><span class="op">)</span>,</span>
<span>  <span class="st">"Phage"</span> <span class="op">=</span> <span class="fu"><a href="../reference/make_designpattern.html">make_designpattern</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Phage Added"</span><span class="op">)</span>, rows <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">8</span>, cols <span class="op">=</span> <span class="fl">7</span><span class="op">:</span><span class="fl">12</span>, pattern <span class="op">=</span> <span class="st">"1"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ex_dat_mrg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/merge_dfs.html">merge_dfs</a></span><span class="op">(</span><span class="va">example_tidydata</span>, <span class="va">example_design</span><span class="op">)</span></span>
<span><span class="co">#&gt; Joining, by = "Well"</span></span>
<span><span class="va">ex_dat_mrg</span><span class="op">$</span><span class="va">Well</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span><span class="op">$</span><span class="va">Well</span>,</span>
<span>         levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span>, each <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">12</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ex_dat_mrg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>, <span class="va">Well</span>, <span class="va">Bacteria_strain</span>, <span class="va">Phage</span><span class="op">)</span></span>
<span><span class="va">ex_dat_mrg</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>,</span>
<span>         deriv <span class="op">=</span> <span class="fu"><a href="../reference/calc_deriv.html">calc_deriv</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">Measurements</span>, x_scale <span class="op">=</span> <span class="fl">3600</span><span class="op">)</span>,</span>
<span>         deriv_percap5 <span class="op">=</span> <span class="fu"><a href="../reference/calc_deriv.html">calc_deriv</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">Measurements</span>, </span>
<span>                                        percapita <span class="op">=</span> <span class="cn">TRUE</span>, blank <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                                        window_width_n <span class="op">=</span> <span class="fl">5</span>, trans_y <span class="op">=</span> <span class="st">"log"</span>,</span>
<span>                                    x_scale <span class="op">=</span> <span class="fl">3600</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sample_wells</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A1"</span>, <span class="st">"F1"</span>, <span class="st">"F10"</span>, <span class="st">"E11"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="Analyzing">Analyzing data with summarize<a class="anchor" aria-label="anchor" href="#Analyzing"></a>
</h2>
<p>Ultimately, analyzing growth curves requires summarizing the entire
time series of data by some metric or metrics. For instance, we may
calculate metrics like:</p>
<ul>
<li>the maximum density</li>
<li>the total area under the curve</li>
<li>the lag time (approximated as the time from the start until maximum
per-capita growth rate is achieved)</li>
<li>the maximum per-capita growth rate</li>
<li>the density when a diauxic shift occurs</li>
<li>the time until diauxic shift occurs</li>
<li>the peak per-capita growth rate after a diauxic shift</li>
<li>the peak density before a decline from phage predation</li>
<li>the time when bacteria drop below some density because of phage
predation</li>
</ul>
<p><code>gcplyr</code> contains a number of functions that make it
easier to carry out these calculations. Additionally,
<code>gcplyr</code> functions are flexible enough that you can use them
in designing your own metric calculations. The following sections
highlight general-use <code>gcplyr</code> functions and provide examples
to calculate the common metrics above.</p>
<p>But first, we need to familiarize ourselves with one more
<code>dplyr</code> function: <code>summarize</code>. Why? Because the
upcoming <code>gcplyr</code> analysis functions <em>must</em> be used
<em>within</em> <code><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">dplyr::summarize</a></code>. <strong>If you’re already
familiar with <code>dplyr</code>’s <code>summarize</code>, feel free to
skip the primer in the next section.</strong> If you’re not familiar
yet, don’t worry! Continue to the next section, where I provide a primer
that will teach you all you need to know on using <code>summarize</code>
with <code>gcplyr</code> functions.</p>
</div>
<div class="section level2">
<h2 id="another-brief-primer-on-dplyr-summarize">Another brief primer on dplyr: summarize<a class="anchor" aria-label="anchor" href="#another-brief-primer-on-dplyr-summarize"></a>
</h2>
<p>Here we’re going to focus on the <code>summarize</code> function from
<code>dplyr</code>, which <em>must</em> be used with the
<code>group_by</code> function we covered in our first primer: <a href="vignette(%22process%22)">A brief primer on dplyr</a>.
<code>summarize</code> carries out user-specified calculations on
<em>each</em> group in a grouped <code>data.frame</code> independently,
producing a new <code>data.frame</code> where each group is now just a
single row.</p>
<p>For growth curves, this means we will:</p>
<ol style="list-style-type: decimal">
<li>
<code>group_by</code> our data so that every well is a group</li>
<li>
<code>summarize</code> each well with calculations like maximum
density or area under the curve</li>
</ol>
<p>Since <code>summarize</code> will drop columns that the data aren’t
grouped by and that aren’t summarized, we will typically want to list
all of our design columns for <code>group_by</code>, along with the
plate name and well. Again, make sure you’re <em>not</em> grouping by
Time, Absorbance, or anything else that varies <em>within</em> a well,
since if you do <code>dplyr</code> will group timepoints within a well
separately.</p>
<p>In the next section, I provide a simple example of how the
<code>max</code> function is used with <code>group_by</code> and
<code>summarize</code> to calculate lag time and the maximum per-capita
growth rate. If you want to learn more, <code>dplyr</code> has extensive
documentation and examples of its own online. Feel free to explore them
as desired, but this primer and the coming example should be sufficient
to use the remaining <code>gcplyr</code> functions.</p>
</div>
<div class="section level2">
<h2 id="summarizing-with-simple-base-functions-maximum-density-and-growth-rate">Summarizing with simple base functions: maximum density and growth
rate<a class="anchor" aria-label="anchor" href="#summarizing-with-simple-base-functions-maximum-density-and-growth-rate"></a>
</h2>
<p>One of the most common steps is calculating global maxima (or minima)
of data. For instance, with bacterial growth, maximum density or growth
rate are some of the most commonly measured traits. Here, we’ll show how
to find them using the built-in <code>max</code> function.</p>
<p>First, we need to group our data. As before, <code>group_by</code>
simply requires the <code>data.frame</code> to be grouped, and the names
of the columns we want to group by.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#First, drop unneeded columns (optional)</span></span>
<span><span class="va">ex_dat_mrg</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>,</span>
<span>                            <span class="va">Time</span>, <span class="va">Well</span>, <span class="va">Measurements</span>, <span class="va">Bacteria_strain</span>, <span class="va">Phage</span>,</span>
<span>                            <span class="va">deriv</span>, <span class="va">deriv_percap5</span><span class="op">)</span></span>
<span><span class="co">#Then, carry out grouping</span></span>
<span><span class="va">ex_dat_mrg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>, <span class="va">Bacteria_strain</span>, <span class="va">Phage</span>, <span class="va">Well</span><span class="op">)</span></span></code></pre></div>
<p>Then, we run <code>summarize</code>. Just like for
<code>mutate</code>, we specify:</p>
<ol style="list-style-type: decimal">
<li>the name of the variable we want results saved to</li>
<li>the function that calculates the summarized results</li>
</ol>
<p>In this case, the function should return just a single value for each
group. For instance, in the code below we’ve calculated the maximum of
the <code>Measurements</code> column, and saved it in a column named
<code>max_dens</code> (note that we need to specify
<code>na.rm = TRUE</code> to tell <code>max</code> to ignore all
<code>NA</code> values). We’ve saved the output from
<code>summarize</code> to a new <code>data.frame</code>:
<code>ex_dat_mrg_sum</code>, short for
example_data_merged_summarized.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ex_dat_mrg_sum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>,</span>
<span>                            max_dens <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">Measurements</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; `summarise()` has grouped output by 'Bacteria_strain', 'Phage'. You can</span></span>
<span><span class="co">#&gt; override using the `.groups` argument.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ex_dat_mrg_sum</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 4</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   Bacteria_strain, Phage [6]</span></span></span>
<span><span class="co">#&gt;   Bacteria_strain Phage       Well  max_dens</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Strain 1        No Phage    A1       1.18 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Strain 1        Phage Added A7       0.499</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Strain 10       No Phage    B4       1.21 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Strain 10       Phage Added B10      0.962</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Strain 11       No Phage    B5       1.21 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Strain 11       Phage Added B11      1.03</span></span></code></pre></div>
<p>If you want additional characteristics, you simply add them to the
summarize. For instance, if we want the time when the maximum density
occurs, you just add that as a second argument. In this case, we use the
<code>which.max</code> function, which returns the index of the maximum
value, to get the index of the <code>Time</code> when the maximum
occurs, and save it to a column titled <code>max_time</code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ex_dat_mrg_sum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>,</span>
<span>                            max_dens <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">Measurements</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                            max_time <span class="op">=</span> <span class="va">Time</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.max</a></span><span class="op">(</span><span class="va">Measurements</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; `summarise()` has grouped output by 'Bacteria_strain', 'Phage'. You can</span></span>
<span><span class="co">#&gt; override using the `.groups` argument.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ex_dat_mrg_sum</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 5</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   Bacteria_strain, Phage [6]</span></span></span>
<span><span class="co">#&gt;   Bacteria_strain Phage       Well  max_dens max_time</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Strain 1        No Phage    A1       1.18     <span style="text-decoration: underline;">86</span>400</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Strain 1        Phage Added A7       0.499    <span style="text-decoration: underline;">31</span>500</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Strain 10       No Phage    B4       1.21     <span style="text-decoration: underline;">85</span>500</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Strain 10       Phage Added B10      0.962    <span style="text-decoration: underline;">30</span>600</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Strain 11       No Phage    B5       1.21     <span style="text-decoration: underline;">70</span>200</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Strain 11       Phage Added B11      1.03     <span style="text-decoration: underline;">86</span>400</span></span></code></pre></div>
<p>And we can quite easily plot such summarized values as a horizontal
line or vertical line on top of our original growth curves data with the
<code>geom_hline</code> or <code>geom_vline</code> functions:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>, <span class="va">Well</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sample_wells</span><span class="op">)</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">Measurements</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Well</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ex_dat_mrg_sum</span>, <span class="va">Well</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sample_wells</span><span class="op">)</span>, </span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">max_dens</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ex_dat_mrg_sum</span>, <span class="va">Well</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sample_wells</span><span class="op">)</span>, </span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">max_time</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="analyze_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>Alternatively, we could plot these summary points as a point:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>, <span class="va">Well</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sample_wells</span><span class="op">)</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">Measurements</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Well</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ex_dat_mrg_sum</span>, <span class="va">Well</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sample_wells</span><span class="op">)</span>, </span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">max_time</span>, y <span class="op">=</span> <span class="va">max_dens</span><span class="op">)</span>,</span>
<span>             size <span class="op">=</span> <span class="fl">2</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="analyze_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<p>We can also use the same process to find the maximum of the
per-capita growth rates that we previously calculated:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ex_dat_mrg_sum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>,</span>
<span>                            max_percap <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">deriv_percap5</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                            max_percap_time <span class="op">=</span> <span class="va">Time</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.max</a></span><span class="op">(</span><span class="va">deriv_percap5</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; `summarise()` has grouped output by 'Bacteria_strain', 'Phage'. You can</span></span>
<span><span class="co">#&gt; override using the `.groups` argument.</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>, <span class="va">Well</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sample_wells</span><span class="op">)</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">deriv_percap5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Well</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ex_dat_mrg_sum</span>, <span class="va">Well</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sample_wells</span><span class="op">)</span>, </span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">max_percap_time</span>, y <span class="op">=</span> <span class="va">max_percap</span><span class="op">)</span>,</span>
<span>             size <span class="op">=</span> <span class="fl">2</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 4 rows containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="analyze_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="summarizing-with-simple-gcplyr-functions-area-under-the-curve">Summarizing with simple gcplyr functions: area under the curve<a class="anchor" aria-label="anchor" href="#summarizing-with-simple-gcplyr-functions-area-under-the-curve"></a>
</h2>
<p>One common metric of growth curves is the total area under the curve.
<code>gcplyr</code> has an <code>auc</code> function to easily calculate
this area. Just like <code>min</code> and <code>max</code>, it needs to
be used inside <code>summarize</code> on a <code>data.frame</code> that
has been grouped.</p>
<p>To use <code>auc</code>, simply specify the x and y data whose
area-under-the-curve you want to calculate. Here, we calculate the
area-under-the-curve of the <code>Measurements</code> column and save it
to a column titled <code>auc</code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ex_dat_mrg_sum</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>,</span>
<span>            auc <span class="op">=</span> <span class="fu"><a href="../reference/auc.html">auc</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">Measurements</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; `summarise()` has grouped output by 'Bacteria_strain', 'Phage'. You can</span></span>
<span><span class="co">#&gt; override using the `.groups` argument.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ex_dat_mrg_sum</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 4</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   Bacteria_strain, Phage [6]</span></span></span>
<span><span class="co">#&gt;   Bacteria_strain Phage       Well     auc</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Strain 1        No Phage    A1    <span style="text-decoration: underline;">57</span>291.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Strain 1        Phage Added A7     <span style="text-decoration: underline;">3</span>856.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Strain 10       No Phage    B4    <span style="text-decoration: underline;">73</span>505.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Strain 10       Phage Added B10   <span style="text-decoration: underline;">22</span>156.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Strain 11       No Phage    B5    <span style="text-decoration: underline;">75</span>289.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Strain 11       Phage Added B11   <span style="text-decoration: underline;">27</span>966.</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="finding-local-extrema-peak-density-maximum-growth-rate-lag-time-and-diauxic-shifts">Finding local extrema: peak density, maximum growth rate, lag time,
and diauxic shifts<a class="anchor" aria-label="anchor" href="#finding-local-extrema-peak-density-maximum-growth-rate-lag-time-and-diauxic-shifts"></a>
</h2>
<p>We’ve previously shown how you can use <code>max</code> and
<code>min</code> to find the global maxima and minima in data. However,
what about <em>local</em> maxima or minima? That is, peaks and valleys
that are obvious to the eye but aren’t the highest or smallest values in
the entire time series. In this section, we’ll show how you can use the
<code>gcplyr</code> functions <code>first_peak</code> and
<code>find_local_extrema</code> to find points that are local maxima or
minima in your data.</p>
<div class="section level3">
<h3 id="finding-the-first-peak-peak-density-maximum-growth-rate-and-lag-time">Finding the first peak: peak density, maximum growth rate, and lag
time<a class="anchor" aria-label="anchor" href="#finding-the-first-peak-peak-density-maximum-growth-rate-and-lag-time"></a>
</h3>
<p>One particular special case we’re often interested in is the first
peak in some set of data. For instance, when bacteria are grown with
phages, the density they reach before they start declining due to phage
predation is a measure of their susceptibility to the phage.
Alternatively, in the previous section we found the global maximum
per-capita growth rate, but what if some of these maxima happened after
near-extinction and recovery and we wanted to only find the peak growth
rate before near-extinction?</p>
<div class="section level4">
<h4 id="peak-density">Peak density<a class="anchor" aria-label="anchor" href="#peak-density"></a>
</h4>
<p>Let’s start with the former example: finding the peak of density.</p>
<p>To identify the first peak, we can use the <code>gcplyr</code>
function <code>first_peak</code>. <code>first_peak</code> simply
requires the <code>y</code> data you want to identify the peak in. In
this case, that’s <code>Measurements</code>. We also need to specify
whether we want the function to <code>return</code> the
<code>index</code> of the first peak, the <code>x</code> value of the
peak, or the <code>y</code> value of the peak. We’ll get the
<code>x</code> and <code>y</code> values, saving them in columns
<code>first_peak_x</code> and <code>first_peak_y</code>, respectively.
As usual, <code>first_peak</code> needs to be used inside of a
<code>summarize</code> command on data that has already been
grouped.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ex_dat_mrg_sum</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>,</span>
<span>            first_peak_x <span class="op">=</span> <span class="fu"><a href="../reference/first_peak.html">first_peak</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">Measurements</span>, return <span class="op">=</span> <span class="st">"x"</span><span class="op">)</span>,</span>
<span>            first_peak_y <span class="op">=</span> <span class="fu"><a href="../reference/first_peak.html">first_peak</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">Measurements</span>, return <span class="op">=</span> <span class="st">"y"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; `summarise()` has grouped output by 'Bacteria_strain', 'Phage'. You can</span></span>
<span><span class="co">#&gt; override using the `.groups` argument.</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ex_dat_mrg_sum</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 5</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   Bacteria_strain, Phage [6]</span></span></span>
<span><span class="co">#&gt;   Bacteria_strain Phage       Well  first_peak_x first_peak_y</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Strain 1        No Phage    A1           <span style="text-decoration: underline;">86</span>400        1.18 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Strain 1        Phage Added A7           <span style="text-decoration: underline;">31</span>500        0.499</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Strain 10       No Phage    B4           <span style="text-decoration: underline;">71</span>100        1.21 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Strain 10       Phage Added B10          <span style="text-decoration: underline;">30</span>600        0.962</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Strain 11       No Phage    B5           <span style="text-decoration: underline;">70</span>200        1.21 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Strain 11       Phage Added B11          <span style="text-decoration: underline;">18</span>900        0.439</span></span></code></pre></div>
<p>Let’s plot these points on all the wells to confirm they are what we
expect:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ex_dat_mrg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">Measurements</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Well</span>, nrow <span class="op">=</span> <span class="fl">8</span>, ncol <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ex_dat_mrg_sum</span>, </span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">first_peak_x</span>, y <span class="op">=</span> <span class="va">first_peak_y</span><span class="op">)</span>, </span>
<span>             color <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="analyze_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<p>That worked great! In some cases, you might find that
<code>first_peak</code> is not sensitive enough, or is too sensitive,
for your data. In those cases, you can adjust the tuning parameters to
make <code>first_peak</code> more or less sensitive to small peaks and
valleys. For <code>first_peak</code>, the tuning parameters are
<code>window_width</code>, <code>window_width_n</code>, and
<code>window_height</code>:</p>
<ul>
<li>
<code>window_width</code> determines the width of the window used to
search for peaks and valleys, in units of <code>x</code>
</li>
<li>
<code>window_width_n</code> determines the width of the window, in
units of number of data points</li>
<li>
<code>window_height</code> determines the shortest peak or
shallowest valley the window will cross, in units of <code>y</code>
</li>
</ul>
</div>
<div class="section level4">
<h4 id="maximum-growth-rate-and-lag-time">Maximum growth rate and lag time<a class="anchor" aria-label="anchor" href="#maximum-growth-rate-and-lag-time"></a>
</h4>
<p>Now let’s look at the other example: using <code>first_peak</code> to
find the first peak in per-capita growth rate. Finding this point tells
us both what the maximum growth rate is, and how long it took the cells
to reach that rate (a measure of lag time).</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ex_dat_mrg_sum</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>,</span>
<span>            max_growth_rate <span class="op">=</span> <span class="fu"><a href="../reference/first_peak.html">first_peak</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">deriv_percap5</span>, </span>
<span>                                         return <span class="op">=</span> <span class="st">"y"</span><span class="op">)</span>,</span>
<span>            lag_time <span class="op">=</span> <span class="fu"><a href="../reference/first_peak.html">first_peak</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">deriv_percap5</span>, </span>
<span>                                  return <span class="op">=</span> <span class="st">"x"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; `summarise()` has grouped output by 'Bacteria_strain', 'Phage'. You can</span></span>
<span><span class="co">#&gt; override using the `.groups` argument.</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ex_dat_mrg_sum</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 5</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   Bacteria_strain, Phage [6]</span></span></span>
<span><span class="co">#&gt;   Bacteria_strain Phage       Well  max_growth_rate lag_time</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Strain 1        No Phage    A1               1.03    <span style="text-decoration: underline;">15</span>300</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Strain 1        Phage Added A7               1.03    <span style="text-decoration: underline;">15</span>300</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Strain 10       No Phage    B4               1.59    <span style="text-decoration: underline;">12</span>600</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Strain 10       Phage Added B10              1.59    <span style="text-decoration: underline;">12</span>600</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Strain 11       No Phage    B5               1.65    <span style="text-decoration: underline;">12</span>600</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Strain 11       Phage Added B11              1.65    <span style="text-decoration: underline;">12</span>600</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>, <span class="va">Well</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sample_wells</span><span class="op">)</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">deriv_percap5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Well</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ex_dat_mrg_sum</span>, <span class="va">Well</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sample_wells</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">lag_time</span>, y <span class="op">=</span> <span class="va">max_growth_rate</span><span class="op">)</span>,</span>
<span>             color <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 4 rows containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="analyze_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<p>But what if you want to find an extrema that’s <em>not</em> the first
peak? In the next section, we’ll learn how to use
<code>find_local_extrema</code> to identify all kinds of local
extrema.</p>
</div>
</div>
<div class="section level3">
<h3 id="finding-any-kind-of-local-extrema-diauxic-shifts">Finding any kind of local extrema: diauxic shifts<a class="anchor" aria-label="anchor" href="#finding-any-kind-of-local-extrema-diauxic-shifts"></a>
</h3>
<p>We’ve seen how <code>first_peak</code> can be used to identify the
first peak in data. But what about other kinds of local extrema? The
first minimum? The <em>second</em> peak?</p>
<p>In order to identify these kinds of extrema, we can use the
more-general function <code>find_local_extrema</code>. In fact,
<code>first_peak</code> is really just a special case of
<code>find_local_extrema</code>. Just like <code>first_peak</code>,
<code>find_local_extrema</code> only requires a vector of y data in
which to find the local extrema, and can return the <code>index</code>,
<code>x</code> value, or <code>y</code> value of the extrema it
finds.</p>
<p>Unlike <code>first_peak</code>, <code>find_local_extrema</code>
returns a vector containing <em>all</em> of the local extrema found
under the given settings. Users can alter which kinds of local extrema
are reported using the arguments <code>return_maxima</code>,
<code>return_minima</code>, and <code>return_endpoints</code>. However,
<code>find_local_extrema</code> will always return a vector of all the
extrema found, so users must use brackets to select which one they want
<code>summarize</code> to save.</p>
<p>Let’s dig into an example: identifying diauxic shifts. To refresh
your memory on what we saw in the derivatives article, here’s a plot of
the derivative of some of the wells over time.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>, <span class="va">Well</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sample_wells</span><span class="op">)</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">deriv</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Well</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 1 row containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="analyze_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<p>In fact, if we look at some more of the wells with no phage added,
we’ll see a similar pattern repeatedly.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sample_wells</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A1"</span>, <span class="st">"A4"</span>, <span class="st">"E2"</span>, <span class="st">"F1"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>, <span class="va">Well</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sample_wells</span><span class="op">)</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">deriv</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Well</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 1 row containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="analyze_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<p>This second, slower, burst of growth after the first wave of growth
is common in bacterial growth curves and is called <em>diauxic
growth</em>.</p>
<p>How could we identify the time when the bacteria switch from their
first burst of growth to their second? We can find the second minima in
the <code>deriv</code> values (where the first minima is going to be at
the start of the growth curve). To do so, we specify to
<code>find_local_extrema</code> that we want <code>return = "x"</code>
and we don’t want maxima returned:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ex_dat_mrg_sum</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>,</span>
<span>    diauxie_time <span class="op">=</span> <span class="fu"><a href="../reference/find_local_extrema.html">find_local_extrema</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">deriv</span>, return <span class="op">=</span> <span class="st">"x"</span>,</span>
<span>                                   return_maxima <span class="op">=</span> <span class="cn">FALSE</span>, return_minima <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                   window_width_n <span class="op">=</span> <span class="fl">39</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; `summarise()` has grouped output by 'Bacteria_strain', 'Phage'. You can</span></span>
<span><span class="co">#&gt; override using the `.groups` argument.</span></span>
<span></span>
<span><span class="co">#Plot data with vertical line at detected diauxie</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>, <span class="va">Well</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sample_wells</span><span class="op">)</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">deriv</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Well</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ex_dat_mrg_sum</span>, <span class="va">Well</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sample_wells</span><span class="op">)</span>, </span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">diauxie_time</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 1 row containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="analyze_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<p>Now that we’ve found the point where the bacteria switch, let’s
identify the density where the diauxic shift occurs. First, we’ll save
the <em>index</em> where the diauxic shift occurs to a column titled
<code>diaxuie_idx</code>. Then, we can get the <code>Measurements</code>
value at that index. (Note that it wouldn’t work to just specify
<code>return = "y"</code>, because the <code>y</code> values in this
case are the <code>deriv</code> values).</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ex_dat_mrg_sum</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span></span>
<span>    <span class="va">ex_dat_mrg</span>,</span>
<span>    diauxie_time <span class="op">=</span> <span class="fu"><a href="../reference/find_local_extrema.html">find_local_extrema</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">deriv</span>, return <span class="op">=</span> <span class="st">"x"</span>,</span>
<span>                                   return_maxima <span class="op">=</span> <span class="cn">FALSE</span>, return_minima <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                   window_width_n <span class="op">=</span> <span class="fl">39</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>    diauxie_idx <span class="op">=</span> <span class="fu"><a href="../reference/find_local_extrema.html">find_local_extrema</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">deriv</span>, return <span class="op">=</span> <span class="st">"index"</span>,</span>
<span>                                   return_maxima <span class="op">=</span> <span class="cn">FALSE</span>, return_minima <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                   window_width_n <span class="op">=</span> <span class="fl">39</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>    diauxie_dens <span class="op">=</span> <span class="va">Measurements</span><span class="op">[</span><span class="va">diauxie_idx</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; `summarise()` has grouped output by 'Bacteria_strain', 'Phage'. You can</span></span>
<span><span class="co">#&gt; override using the `.groups` argument.</span></span>
<span></span>
<span><span class="co">#Plot data with a point at the moment of diauxic shift</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>, <span class="va">Well</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sample_wells</span><span class="op">)</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">Measurements</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Well</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ex_dat_mrg_sum</span>, <span class="va">Well</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sample_wells</span><span class="op">)</span>, </span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">diauxie_time</span>, y <span class="op">=</span> <span class="va">diauxie_dens</span><span class="op">)</span>,</span>
<span>             size <span class="op">=</span> <span class="fl">2</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="analyze_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
<p>Something that was hard to see on the density plot has now been
easily quantified and can be visualized exactly where the shift
occurs.</p>
</div>
<div class="section level3">
<h3 id="combining-subsets-and-local-extrema-diauxic-growth-rate">Combining subsets and local extrema: diauxic growth rate<a class="anchor" aria-label="anchor" href="#combining-subsets-and-local-extrema-diauxic-growth-rate"></a>
</h3>
<p>In the previous section we identified when the bacteria shifted into
their second burst of growth. Can we find out what the peak per-capita
growth rate was during that second burst? Yes, we just have to put
together some of the things we’ve learned already. In particular, we’re
going to combine our use of <code>find_local_extrema</code>,
<code>max</code>, and subsets to find the
<code>max(deriv_percap_hr)</code> during the times after the diauxic
shift:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ex_dat_mrg_sum</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span></span>
<span>    <span class="va">ex_dat_mrg</span>,</span>
<span>    diauxie_time <span class="op">=</span> <span class="fu"><a href="../reference/find_local_extrema.html">find_local_extrema</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">deriv</span>, return <span class="op">=</span> <span class="st">"x"</span>,</span>
<span>                                   return_maxima <span class="op">=</span> <span class="cn">FALSE</span>, return_minima <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                   window_width_n <span class="op">=</span> <span class="fl">39</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>    diauxie_percap <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">deriv_percap5</span><span class="op">[</span><span class="va">Time</span> <span class="op">&gt;=</span> <span class="va">diauxie_time</span><span class="op">]</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    diauxie_percap_time <span class="op">=</span> </span>
<span>      <span class="va">Time</span><span class="op">[</span><span class="va">Time</span> <span class="op">&gt;=</span> <span class="va">diauxie_time</span><span class="op">]</span><span class="op">[</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.max</a></span><span class="op">(</span><span class="va">deriv_percap5</span><span class="op">[</span><span class="va">Time</span> <span class="op">&gt;=</span> <span class="va">diauxie_time</span><span class="op">]</span><span class="op">)</span><span class="op">]</span></span>
<span>    <span class="op">)</span></span>
<span><span class="co">#&gt; `summarise()` has grouped output by 'Bacteria_strain', 'Phage'. You can</span></span>
<span><span class="co">#&gt; override using the `.groups` argument.</span></span>
<span></span>
<span><span class="co">#Plot data with a point at the moment of peak diauxic growth rate</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>, <span class="va">Well</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sample_wells</span><span class="op">)</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">deriv_percap5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Well</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ex_dat_mrg_sum</span>, <span class="va">Well</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sample_wells</span><span class="op">)</span>, </span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">diauxie_percap_time</span>, y <span class="op">=</span> <span class="va">diauxie_percap</span><span class="op">)</span>,</span>
<span>             size <span class="op">=</span> <span class="fl">2</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 4 rows containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="analyze_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="finding-threshold-crossings-extinction-time-and-time-to-density">Finding threshold-crossings: extinction time and time to
density<a class="anchor" aria-label="anchor" href="#finding-threshold-crossings-extinction-time-and-time-to-density"></a>
</h2>
<p>We’ve previously shown how you can find local and global extrema in
data, but what if you just want to find when the data passes some
threshold value? In this section, we’ll show how you can use the
<code>gcplyr</code> functions <code>first_below</code> and
<code>find_threshold_crosses</code> to find the points when your data
crosses user-defined thresholds.</p>
<div class="section level3">
<h3 id="finding-the-first-point-below-a-threshold-extinction-time">Finding the first point below a threshold: extinction time<a class="anchor" aria-label="anchor" href="#finding-the-first-point-below-a-threshold-extinction-time"></a>
</h3>
<p>One common case of threshold-crossing we might be interested in is
the first point that our data falls below some threshold density. For
instance, when bacteria are grown with phages, the amount of time it
takes before the bacterial population falls below some threshold can be
a proxy metric for how sensitive the bacteria are to that phage.</p>
<p>Let’s take a look at the absorbance values in some example wells with
both bacteria and phages:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sample_wells</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A7"</span>, <span class="st">"B10"</span>, <span class="st">"F10"</span>, <span class="st">"H8"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>, <span class="va">Well</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sample_wells</span><span class="op">)</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">Measurements</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Well</span><span class="op">)</span></span></code></pre></div>
<p><img src="analyze_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
<p>Ok great. Now let’s suppose that I think that an absorbance of 0.15
is a good threshold for extinction in my experiment. How could we use
<code>first_below</code> to calculate the time when that first occurs
across all our different wells? Well, primarily,
<code>first_below</code> simply needs our <code>x</code> and
<code>y</code> values, the <code>threshold</code> we want to use, as
well as whether we want it to <code>return</code> the <code>index</code>
of the first point below the threshold, or the <code>x</code> value of
that point (since we care about the time it happened here, we’ll do the
latter). Additionally, we’ll specify that we don’t care if the
startpoint is below the threshold: we only care when the data goes from
above to below it.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ex_dat_mrg_sum</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span></span>
<span>    <span class="va">ex_dat_mrg</span>,</span>
<span>    extin_time <span class="op">=</span> <span class="fu"><a href="../reference/first_below.html">first_below</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">Measurements</span>, threshold <span class="op">=</span> <span class="fl">0.15</span>,</span>
<span>                             return <span class="op">=</span> <span class="st">"x"</span>, return_endpoints <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; `summarise()` has grouped output by 'Bacteria_strain', 'Phage'. You can</span></span>
<span><span class="co">#&gt; override using the `.groups` argument.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ex_dat_mrg_sum</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 4</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   Bacteria_strain, Phage [6]</span></span></span>
<span><span class="co">#&gt;   Bacteria_strain Phage       Well  extin_time</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Strain 1        No Phage    A1           <span style="color: #BB0000;">NA</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Strain 1        Phage Added A7        <span style="text-decoration: underline;">33</span>063.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Strain 10       No Phage    B4           <span style="color: #BB0000;">NA</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Strain 10       Phage Added B10       <span style="text-decoration: underline;">34</span>946.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Strain 11       No Phage    B5           <span style="color: #BB0000;">NA</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Strain 11       Phage Added B11       <span style="text-decoration: underline;">20</span>319.</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>, <span class="va">Well</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sample_wells</span><span class="op">)</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">Measurements</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Well</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ex_dat_mrg_sum</span>, <span class="va">Well</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sample_wells</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">extin_time</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="analyze_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
<p>All the phage-added wells have a time when the bacteria drop below
that threshold, and the plot clearly shows that it’s right where we’d
expect it.</p>
</div>
<div class="section level3">
<h3 id="finding-any-kind-of-threshold-crossing-time-to-density">Finding any kind of threshold-crossing: time to density<a class="anchor" aria-label="anchor" href="#finding-any-kind-of-threshold-crossing-time-to-density"></a>
</h3>
<p>We’ve seen how <code>first_below</code> can be used to identify the
first point some data crosses below a threshold. But what about other
kinds of threshold-crossing events? The first point it passes above a
threshold? The first point it’s ever below a threshold, including at the
start?</p>
<p>In order to identify these kinds of extrema, we can use the
more-general function <code>find_threshold_crosses</code>. In fact,
<code>first_below</code> is really just a special case of
<code>find_threshold_crosses</code>. Just like <code>first_below</code>,
<code>find_threshold_crosses</code> only requires a
<code>threshold</code> and a vector of <code>y</code> data in which to
find the threshold crosses, and can return the <code>index</code> or
<code>x</code> value of the crossing events it finds.</p>
<p>However, unlike <code>first_below</code>,
<code>find_threshold_crosses</code> returns a vector containing
<em>all</em> of the threshold crossings found under the given settings.
Users can alter which kinds of threshold crossings are reported using
the arguments <code>return_rising</code>, <code>return_falling</code>,
and <code>return_endpoints</code>. However,
<code>find_threshold_crosses</code> will always return a vector of all
the extrema found, so users must use brackets to select which one they
want <code>summarize</code> to save.</p>
<p>Let’s dig into an example: identifying the first time the bacteria
reach some density, including if they start at that density</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sample_wells</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A1"</span>, <span class="st">"F1"</span>, <span class="st">"F10"</span>, <span class="st">"E11"</span><span class="op">)</span></span>
<span><span class="va">ex_dat_mrg_sum</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span></span>
<span>    <span class="va">ex_dat_mrg</span>,</span>
<span>    time_to_01 <span class="op">=</span> <span class="fu"><a href="../reference/find_threshold_crosses.html">find_threshold_crosses</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">Measurements</span>, </span>
<span>                                        threshold <span class="op">=</span> <span class="fl">0.1</span>, return <span class="op">=</span> <span class="st">"x"</span>, </span>
<span>                                        return_endpoints <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                                        return_falling <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>    time_to_05 <span class="op">=</span> <span class="fu"><a href="../reference/find_threshold_crosses.html">find_threshold_crosses</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">Measurements</span>, </span>
<span>                                        threshold <span class="op">=</span> <span class="fl">0.5</span>, return <span class="op">=</span> <span class="st">"x"</span>, </span>
<span>                                        return_endpoints <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                                        return_falling <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; `summarise()` has grouped output by 'Bacteria_strain', 'Phage'. You can</span></span>
<span><span class="co">#&gt; override using the `.groups` argument.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ex_dat_mrg_sum</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 5</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   Bacteria_strain, Phage [6]</span></span></span>
<span><span class="co">#&gt;   Bacteria_strain Phage       Well  time_to_01 time_to_05</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Strain 1        No Phage    A1        <span style="text-decoration: underline;">21</span>913.     <span style="text-decoration: underline;">31</span>194.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Strain 1        Phage Added A7        <span style="text-decoration: underline;">21</span>913.        <span style="color: #BB0000;">NA</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Strain 10       No Phage    B4        <span style="text-decoration: underline;">15</span>300      <span style="text-decoration: underline;">20</span>624.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Strain 10       Phage Added B10       <span style="text-decoration: underline;">15</span>300      <span style="text-decoration: underline;">20</span>624.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Strain 11       No Phage    B5        <span style="text-decoration: underline;">14</span>543.     <span style="text-decoration: underline;">19</span>490 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Strain 11       Phage Added B11       <span style="text-decoration: underline;">14</span>543.     <span style="text-decoration: underline;">59</span>955</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>, <span class="va">Well</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sample_wells</span><span class="op">)</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">Measurements</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Well</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ex_dat_mrg_sum</span>, <span class="va">Well</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sample_wells</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">time_to_01</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ex_dat_mrg_sum</span>, <span class="va">Well</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sample_wells</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">time_to_05</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 1 rows containing missing values (`geom_vline()`).</span></span></code></pre></div>
<p><img src="analyze_files/figure-html/unnamed-chunk-20-1.png" width="700">
As we can see, <code>find_threshold_crosses</code> has returned the
times when the bacteria reached those densities. We can see that some
bacteria (e.g. those in Well F10) never reached 0.5, so they have an
<code>NA</code> value for <code>time_to_05</code>. By comparing the
times it took each strain to reach an absorbance of 0.1, we could learn
something about how soon the bacteria started growing and how quickly
they grew.</p>
</div>
</div>
<div class="section level2">
<h2 id="whats-next">What’s next?<a class="anchor" aria-label="anchor" href="#whats-next"></a>
</h2>
<p>Now that you’ve analyzed your data, you can read about approaches to
deal with noise in your growth curve data, or you can read some
concluding notes on best practices for running statistics, merging
growth curve analyses with other data, and additional resources for
analyzing growth curves.</p>
<ol style="list-style-type: decimal">
<li>Introduction: <code><a href="../articles/gcplyr.html">vignette("gcplyr")</a></code>
</li>
<li>Importing and transforming data:
<code><a href="../articles/import_transform.html">vignette("import_transform")</a></code>
</li>
<li>Incorporating design information:
<code><a href="../articles/incorporate_designs.html">vignette("incorporate_designs")</a></code>
</li>
<li>Pre-processing and plotting your data:
<code><a href="../articles/preprocess_plot.html">vignette("preprocess_plot")</a></code>
</li>
<li>Processing your data: <code><a href="../articles/process.html">vignette("process")</a></code>
</li>
<li>Analyzing your data: <code><a href="../articles/analyze.html">vignette("analyze")</a></code>
</li>
<li>
<strong>Dealing with noise:</strong>
<code><a href="../articles/noise.html">vignette("noise")</a></code>
</li>
<li>
<strong>Statistics, merging other data, and other
resources:</strong> <code><a href="../articles/conclusion.html">vignette("conclusion")</a></code>
</li>
</ol>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://mikeblazanin.wordpress.com" class="external-link">Mike Blazanin</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
