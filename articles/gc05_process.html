<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="gcplyr">
<title>Processing data • gcplyr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Processing data">
<meta property="og:description" content="gcplyr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">gcplyr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.8.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/gc01_gcplyr.html">Introduction</a>
    <a class="dropdown-item" href="../articles/gc02_import_reshape.html">Importing and reshaping data</a>
    <a class="dropdown-item" href="../articles/gc03_incorporate_designs.html">Incorporating experimental designs</a>
    <a class="dropdown-item" href="../articles/gc04_preprocess_plot.html">Pre-processing and plotting data</a>
    <a class="dropdown-item" href="../articles/gc05_process.html">Processing data</a>
    <a class="dropdown-item" href="../articles/gc06_analyze.html">Analyzing data</a>
    <a class="dropdown-item" href="../articles/gc07_noise.html">Dealing with noise</a>
    <a class="dropdown-item" href="../articles/gc08_conclusion.html">Statistics, merging other data, and other resources</a>
    <a class="dropdown-item" href="../articles/gc09_multiple_plates.html">Working with multiple plates</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/mikeblazanin/gcplyr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Processing data</h1>
                        <h4 data-toc-skip class="author">Mike
Blazanin</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mikeblazanin/gcplyr/blob/HEAD/vignettes/gc05_process.Rmd" class="external-link"><code>vignettes/gc05_process.Rmd</code></a></small>
      <div class="d-none name"><code>gc05_process.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="where-are-we-so-far">Where are we so far?<a class="anchor" aria-label="anchor" href="#where-are-we-so-far"></a>
</h2>
<ol style="list-style-type: decimal">
<li>Introduction: <code><a href="../articles/gc01_gcplyr.html">vignette("gc01_gcplyr")</a></code>
</li>
<li>Importing and transforming data:
<code><a href="../articles/gc02_import_reshape.html">vignette("gc02_import_reshape")</a></code>
</li>
<li>Incorporating experimental designs:
<code><a href="../articles/gc03_incorporate_designs.html">vignette("gc03_incorporate_designs")</a></code>
</li>
<li>Pre-processing and plotting your data:
<code><a href="../articles/gc04_preprocess_plot.html">vignette("gc04_preprocess_plot")</a></code>
</li>
<li>
<strong>Processing your data:</strong>
<code><a href="../articles/gc05_process.html">vignette("gc05_process")</a></code>
</li>
<li>Analyzing your data: <code><a href="../articles/gc06_analyze.html">vignette("gc06_analyze")</a></code>
</li>
<li>Dealing with noise: <code><a href="../articles/gc07_noise.html">vignette("gc07_noise")</a></code>
</li>
<li>Statistics, merging other data, and other resources:
<code><a href="../articles/gc08_conclusion.html">vignette("gc08_conclusion")</a></code>
</li>
<li>Working with multiple plates:
<code><a href="../articles/gc09_multiple_plates.html">vignette("gc09_multiple_plates")</a></code>
</li>
</ol>
<p>So far, we’ve imported and transformed our measures, combined them
with our design information, and pre-processed and plotted our data. Now
we’re going to do some processing of our raw data: calculating
derivatives.</p>
<p>If you haven’t already, load the necessary packages.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mikeblazanin.github.io/gcplyr/">gcplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; ## </span></span>
<span><span class="co">#&gt; ## gcplyr (Version 1.8.0, Build Date: 2024-01-29)</span></span>
<span><span class="co">#&gt; ## See http://github.com/mikeblazanin/gcplyr for additional documentation</span></span>
<span><span class="co">#&gt; ## Please cite software as:</span></span>
<span><span class="co">#&gt; ##   Blazanin, Michael. 2023. gcplyr: an R package for microbial growth</span></span>
<span><span class="co">#&gt; ##   curve data analysis. bioRxiv doi: 10.1101/2023.04.30.538883</span></span>
<span><span class="co">#&gt; ##</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># This code was previously explained</span></span>
<span><span class="co"># Here we're re-running it so it's available for us to work with</span></span>
<span><span class="va">example_tidydata</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/trans_wide_to_tidy.html">trans_wide_to_tidy</a></span><span class="op">(</span><span class="va">example_widedata_noiseless</span>,</span>
<span>                                       id_cols <span class="op">=</span> <span class="st">"Time"</span><span class="op">)</span></span>
<span><span class="va">ex_dat_mrg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/merge_dfs.html">merge_dfs</a></span><span class="op">(</span><span class="va">example_tidydata</span>, <span class="va">example_design_tidy</span><span class="op">)</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(Well)`</span></span>
<span><span class="va">ex_dat_mrg</span><span class="op">$</span><span class="va">Well</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span><span class="op">$</span><span class="va">Well</span>,</span>
<span>         levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span>, each <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">12</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#Convert time to hours</span></span>
<span><span class="va">ex_dat_mrg</span><span class="op">$</span><span class="va">Time</span> <span class="op">&lt;-</span> <span class="va">ex_dat_mrg</span><span class="op">$</span><span class="va">Time</span><span class="op">/</span><span class="fl">3600</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="how-to-process-and-analyze-your-data">How to process and analyze your data<a class="anchor" aria-label="anchor" href="#how-to-process-and-analyze-your-data"></a>
</h2>
<p>With your data and design information pre-processed, <strong>your
dataset is now organized in a way that’s easy to export and
analyze</strong>.</p>
<p>Broadly speaking, there are two main approaches to analyzing growth
curves data:</p>
<ol style="list-style-type: decimal">
<li>directly quantify attributes of the growth dynamics (what
<strong>gcplyr</strong> does)</li>
<li>fit the growth dynamics with a mathematical model, then extract
parameters from the fitted model (what <strong>other packages</strong>
do, see vignette(“08_conclusion”))</li>
</ol>
<p>At this point, since the data is now well-organized, advanced users
may also decide they want to write their own custom analyses (in lieu
of, or alongside, <code>gcplyr</code>-based and/or fitting-based
analyses).</p>
<p>So, how do we directly quantify attributes of growth curves?
Generally, we find features of the density data and its derivatives.
Different projects may desire different analyses, so this article and
the <a href="vignette(%2206_analyze%22)">Analyzing Data</a> and <a href="vignette(%2207_noise%22)">Dealing with Noise</a> articles are
written to highlight common analyses, rather than prescribing what
everyone should do.</p>
<p>Below I list common metrics that require derivatives to be
calculated. If you intend to calculate any of those metrics, or just
want to calculate or plot the derivatives, continue reading. Otherwise,
feel free to skip right to the <a href="vignette(%2206_analyze%22)">Analyzing Data</a> article.</p>
<p><strong>Metrics requiring derivatives:</strong></p>
<ul>
<li>the lag time</li>
<li>the time to reach some growth rate</li>
<li>the maximum per-capita growth rate (i.e. minimum doubling time)</li>
<li>the inflection point</li>
<li>the density and time when a diauxic shift occurs</li>
<li>the maximum per-capita growth rate during diauxie</li>
</ul>
<p>Before we dig into calculating derivatives, we first need to
familiarize ourselves with the <code>dplyr</code> package and its
functions <code>group_by</code> and <code>mutate</code>. Why? Because
the upcoming <code>gcplyr</code> processing functions are <em>best</em>
used <strong>within</strong> <code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">dplyr::mutate</a></code>. <strong>If
you’re already familiar with <code>dplyr</code>, feel free to skip
straight to <a href="#CalculatingDerivatives">Calculating
Derivatives</a>.</strong> If you’re not familiar yet, the primer will
teach you all you need to know to use <code>gcplyr</code>.</p>
<div class="section level3">
<h3 id="a-brief-primer-on-dplyr">A brief primer on dplyr<a class="anchor" aria-label="anchor" href="#a-brief-primer-on-dplyr"></a>
</h3>
<p>The <code>R</code> package <code>dplyr</code> provides a “grammar of
data manipulation” that is useful for a broad array of data analysis
tasks (in fact, <code>dplyr</code> is the direct inspiration for the
name of <code>gcplyr</code>!) For our purposes, we’re going to focus on
two functions: <code>group_by</code> and <code>mutate</code>.</p>
<p>The <code>mutate</code> function in <code>dplyr</code> allows users
to easily create new columns in their <code>data.frame</code>’s. For us,
we’re going to use <code>mutate</code> to create columns with the
derivatives we calculate. However, we want to make sure that
derivative-calculating is done on <em>each</em> unique well
independently. In order to do that, we’re first going to use the
<code>group_by</code> function, which allows users to group the rows of
their <code>data.frame</code>’s into groups that <code>mutate</code>
will then treat independently.</p>
<p>For growth curves, this means we will:</p>
<ol style="list-style-type: decimal">
<li>
<code>group_by</code> our data so that every unique well is a
group</li>
<li>
<code>mutate</code> to create new columns with our calculated
derivatives</li>
</ol>
<p>For <code>group_by</code>, we need to specify the
<code>data.frame</code> to be grouped, and then we want to list all the
columns needed to identify each unique well in our dataset. Typically,
this includes all of our design columns along with the plate name and
well name. Make sure you’re <em>not</em> grouping by Time, Absorbance,
or anything else that varies <em>within</em> a well, since if you do
<code>dplyr</code> will group timepoints within a well separately.</p>
<p>To use <code>mutate</code>, we simply have to specify:</p>
<ol style="list-style-type: decimal">
<li>the name of the variable we want results saved to</li>
<li>the function that calculates the new column</li>
</ol>
<p>If you want additional columns, you simply add them to the
<code>mutate</code>.</p>
<p>As you’ll see throughout the rest of this article, we’ll be using
<code>group_by</code> and <code>mutate</code> to calculate derivatives.
If you want to learn more, <code>dplyr</code> has extensive
documentation and examples of its own online, but this primer and the
coming examples should be sufficient to calculate derivatives with
<code>gcplyr</code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="CalculatingDerivatives">Processing data: calculating derivatives<a class="anchor" aria-label="anchor" href="#CalculatingDerivatives"></a>
</h2>
<p>There are two derivatives we are primarily interested in
calculating:</p>
<ul>
<li>the plain derivative - the slope of the original density data</li>
<li>the per-capita derivative - the growth rate of the cells</li>
</ul>
<p><code>gcplyr</code> includes a <code>calc_deriv</code> to calculate
both of these.</p>
<div class="section level3">
<h3 id="a-simple-derivative">A simple derivative<a class="anchor" aria-label="anchor" href="#a-simple-derivative"></a>
</h3>
<p>To calculate a simple derivative (the slope of our original data)
using <code>calc_deriv</code>, we simply have to provide the x and y
values. Note that this is <strong>not</strong> the growth rate of the
cells, but rather is a measure of how quickly the whole population was
growing at each time point.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ex_dat_mrg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>, <span class="va">Well</span>, <span class="va">Bacteria_strain</span>, <span class="va">Phage</span><span class="op">)</span>,</span>
<span>                     deriv <span class="op">=</span> <span class="fu"><a href="../reference/calc_deriv.html">calc_deriv</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">Measurements</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>To visualize these results, let’s look at a few wells that are
representative of the overall diversity of dynamics in our example data.
(In your own code, you should visualize all your data).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sample_wells</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A1"</span>, <span class="st">"F1"</span>, <span class="st">"F10"</span>, <span class="st">"E11"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Now let's plot the derivative</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>, <span class="va">Well</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sample_wells</span><span class="op">)</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">deriv</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Well</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 1 row containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="gc05_process_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p>You might notice that these lines aren’t super smooth. Why? The plate
reader data has a limited resolution, only to the nearest 0.001, causing
the derivative to “jump” when the reading increases.</p>
</div>
<div class="section level3">
<h3 id="per-capita-derivative">Per-capita derivative<a class="anchor" aria-label="anchor" href="#per-capita-derivative"></a>
</h3>
<p>To calculate the per-capita derivative, we simply modify our use of
<code>calc_deriv</code> with the argument <code>percapita = TRUE</code>.
Note that in this case, you are required to specify a blank value,
i.e. the value of your <code>Measurements</code> that corresponds to a
population density of 0. If your data have already been normalized,
simply add <code>blank = 0</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ex_dat_mrg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>, <span class="va">Well</span>, <span class="va">Bacteria_strain</span>, <span class="va">Phage</span><span class="op">)</span>,</span>
<span>                     deriv_percap <span class="op">=</span> <span class="fu"><a href="../reference/calc_deriv.html">calc_deriv</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">Measurements</span>,</span>
<span>                                        percapita <span class="op">=</span> <span class="cn">TRUE</span>, blank <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Now let's plot the per-capita derivative</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>, <span class="va">Well</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sample_wells</span><span class="op">)</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">deriv_percap</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Well</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 1 row containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="gc05_process_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>These derivatives are very jumpy. Why? The same limited resolution of
the plate reader has an amplified effect on the per-capita derivative
when densities are very close to 0. Luckily, <code>calc_deriv</code> can
calculate derives by fitting a linear regression to multiple points,
reducing this jumpiness in the derivative.</p>
<p>To use this fitting functionality of <code>calc_deriv</code>, specify
either the <code>window_width</code> or <code>window_width_n</code>
parameter. <code>window_width</code> specifies how wide the window used
to include points for the fitting is in units of <code>x</code>, while
<code>window_width_n</code> specifies it in number of data points. I
recommend trying a <code>window_width_n</code> of three or five data
points, since that works for most cases.</p>
<p>For best practice, I recommend doing this fitting on log-transformed
<code>y</code> values, since exponentially growing density values are
linear when log-transformed. You can achieve this simply by setting
<code>trans_y = 'log'</code>. With log-transformation, note that
<code>calc_deriv</code> will return <code>NA</code> for any data points
where the reading is equal to or below your <code>blank</code>
value.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ex_dat_mrg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>, <span class="va">Well</span>, <span class="va">Bacteria_strain</span>, <span class="va">Phage</span><span class="op">)</span>,</span>
<span>                     deriv_percap5 <span class="op">=</span> <span class="fu"><a href="../reference/calc_deriv.html">calc_deriv</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">Measurements</span>, </span>
<span>                                        percapita <span class="op">=</span> <span class="cn">TRUE</span>, blank <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                                        window_width_n <span class="op">=</span> <span class="fl">5</span>, trans_y <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Now let's plot the derivative</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>, <span class="va">Well</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sample_wells</span><span class="op">)</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">deriv_percap5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Well</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 4 rows containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="gc05_process_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>Great! The jumpiness has been reduced immensely.</p>
</div>
<div class="section level3">
<h3 id="converting-per-capita-growth-rates-into-doubling-times">Converting per-capita growth rates into doubling times<a class="anchor" aria-label="anchor" href="#converting-per-capita-growth-rates-into-doubling-times"></a>
</h3>
<p>If you’d rather express your per-capita growth rates as a doubling
time, simply use the <code>doubling_time</code> function to convert your
per-capita growth rates into equivalent doubling times.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ex_dat_mrg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>, <span class="va">Well</span>, <span class="va">Bacteria_strain</span>, <span class="va">Phage</span><span class="op">)</span>,</span>
<span>                     deriv_percap5 <span class="op">=</span> <span class="fu"><a href="../reference/calc_deriv.html">calc_deriv</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">Measurements</span>, </span>
<span>                                        percapita <span class="op">=</span> <span class="cn">TRUE</span>, blank <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                                        window_width_n <span class="op">=</span> <span class="fl">5</span>, trans_y <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span>,</span>
<span>                     doub_time <span class="op">=</span> <span class="fu"><a href="../reference/doubling_time.html">doubling_time</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">deriv_percap5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 9</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   Well, Bacteria_strain, Phage [4]</span></span></span>
<span><span class="co">#&gt;    Time Well  Measurements Bacteria_strain Phage       deriv deriv_percap</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>  0    A1           0.002 Strain 1        No Phage        0            0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>  0    F1           0.002 Strain 31       No Phage        0            0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>  0    F10          0.002 Strain 34       Phage Added     0            0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>  0    E11          0.002 Strain 29       Phage Added     0            0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>  0.25 A1           0.002 Strain 1        No Phage        0            0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>  0.25 F1           0.002 Strain 31       No Phage        0            0</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 2 more variables: deriv_percap5 &lt;dbl&gt;, doub_time &lt;dbl&gt;</span></span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="whats-next">What’s next?<a class="anchor" aria-label="anchor" href="#whats-next"></a>
</h2>
<p>Now that you’ve processed your data, you’re ready to analyze it!</p>
<ol style="list-style-type: decimal">
<li>Introduction: <code><a href="../articles/gc01_gcplyr.html">vignette("gc01_gcplyr")</a></code>
</li>
<li>Importing and transforming data:
<code><a href="../articles/gc02_import_reshape.html">vignette("gc02_import_reshape")</a></code>
</li>
<li>Incorporating experimental designs:
<code><a href="../articles/gc03_incorporate_designs.html">vignette("gc03_incorporate_designs")</a></code>
</li>
<li>Pre-processing and plotting your data:
<code><a href="../articles/gc04_preprocess_plot.html">vignette("gc04_preprocess_plot")</a></code>
</li>
<li>Processing your data: <code><a href="../articles/gc05_process.html">vignette("gc05_process")</a></code>
</li>
<li><strong>Analyzing your data:
<code><a href="../articles/gc06_analyze.html">vignette("gc06_analyze")</a></code></strong></li>
<li>Dealing with noise: <code><a href="../articles/gc07_noise.html">vignette("gc07_noise")</a></code>
</li>
<li>Statistics, merging other data, and other resources:
<code><a href="../articles/gc08_conclusion.html">vignette("gc08_conclusion")</a></code>
</li>
<li>Working with multiple plates:
<code><a href="../articles/gc09_multiple_plates.html">vignette("gc09_multiple_plates")</a></code>
</li>
</ol>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://mikeblazanin.wordpress.com" class="external-link">Mike Blazanin</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
