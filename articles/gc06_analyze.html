<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="gcplyr">
<title>Analyzing data • gcplyr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Analyzing data">
<meta property="og:description" content="gcplyr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">gcplyr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.7.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/gcplyr.html">Introduction</a>
    <a class="dropdown-item" href="../articles/import_transform.html">Importing and transforming data</a>
    <a class="dropdown-item" href="../articles/incorporate_designs.html">Incorporating design information</a>
    <a class="dropdown-item" href="../articles/preprocess_plot.html">Pre-processing and plotting data</a>
    <a class="dropdown-item" href="../articles/process.html">Processing data</a>
    <a class="dropdown-item" href="../articles/analyze.html">Analyzing data</a>
    <a class="dropdown-item" href="../articles/noise.html">Dealing with noise</a>
    <a class="dropdown-item" href="../articles/conclusion.html">Statistics, merging other data, and other resources</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/mikeblazanin/gcplyr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Analyzing data</h1>
                        <h4 data-toc-skip class="author">Mike
Blazanin</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mikeblazanin/gcplyr/blob/HEAD/vignettes/gc06_analyze.Rmd" class="external-link"><code>vignettes/gc06_analyze.Rmd</code></a></small>
      <div class="d-none name"><code>gc06_analyze.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="where-are-we-so-far">Where are we so far?<a class="anchor" aria-label="anchor" href="#where-are-we-so-far"></a>
</h2>
<ol style="list-style-type: decimal">
<li>Introduction: <code><a href="../articles/gc01_gcplyr.html">vignette("gc01_gcplyr")</a></code>
</li>
<li>Importing and transforming data:
<code><a href="../articles/gc02_import_transform.html">vignette("gc02_import_transform")</a></code>
</li>
<li>Incorporating design information:
<code><a href="../articles/gc03_incorporate_designs.html">vignette("gc03_incorporate_designs")</a></code>
</li>
<li>Pre-processing and plotting your data:
<code><a href="../articles/gc04_preprocess_plot.html">vignette("gc04_preprocess_plot")</a></code>
</li>
<li>Processing your data: <code><a href="../articles/gc05_process.html">vignette("gc05_process")</a></code>
</li>
<li>
<strong>Analyzing your data:</strong>
<code><a href="../articles/gc06_analyze.html">vignette("gc06_analyze")</a></code>
</li>
<li>Dealing with noise: <code><a href="../articles/gc07_noise.html">vignette("gc07_noise")</a></code>
</li>
<li>Statistics, merging other data, and other resources:
<code><a href="../articles/gc08_conclusion.html">vignette("gc08_conclusion")</a></code>
</li>
<li>Working with multiple plates:
<code><a href="../articles/gc09_multiple_plates.html">vignette("gc09_multiple_plates")</a></code>
</li>
</ol>
<p>So far, we’ve imported and transformed our measures, combined them
with our design information, pre-processed, processed, and plotted our
data. Now we’re going to analyze our data by summarizing our growth
curves into a number of metrics.</p>
<p>If you haven’t already, load the necessary packages.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mikeblazanin.github.io/gcplyr/">gcplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; ## </span></span>
<span><span class="co">#&gt; ## gcplyr (Version 1.7.0, Build Date: 2023-11-03)</span></span>
<span><span class="co">#&gt; ## See http://github.com/mikeblazanin/gcplyr for additional documentation</span></span>
<span><span class="co">#&gt; ## Please cite software as:</span></span>
<span><span class="co">#&gt; ##   Blazanin, Michael. 2023. gcplyr: an R package for microbial growth</span></span>
<span><span class="co">#&gt; ##   curve data analysis. bioRxiv doi: 10.1101/2023.04.30.538883</span></span>
<span><span class="co">#&gt; ##</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># This code was previously explained</span></span>
<span><span class="co"># Here we're re-running it so it's available for us to work with</span></span>
<span><span class="va">example_tidydata</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/trans_wide_to_tidy.html">trans_wide_to_tidy</a></span><span class="op">(</span><span class="va">example_widedata_noiseless</span>,</span>
<span>                                       id_cols <span class="op">=</span> <span class="st">"Time"</span><span class="op">)</span></span>
<span><span class="va">example_design</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_design.html">make_design</a></span><span class="op">(</span></span>
<span>  pattern_split <span class="op">=</span> <span class="st">","</span>, nrows <span class="op">=</span> <span class="fl">8</span>, ncols <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  <span class="st">"Bacteria_strain"</span> <span class="op">=</span> <span class="fu"><a href="../reference/make_designpattern.html">make_designpattern</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Strain"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">48</span><span class="op">)</span>,</span>
<span>    rows <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">8</span>, cols <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, pattern <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">48</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  <span class="st">"Bacteria_strain"</span> <span class="op">=</span> <span class="fu"><a href="../reference/make_designpattern.html">make_designpattern</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Strain"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">48</span><span class="op">)</span>,</span>
<span>    rows <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">8</span>, cols <span class="op">=</span> <span class="fl">7</span><span class="op">:</span><span class="fl">12</span>, pattern <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">48</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  <span class="st">"Phage"</span> <span class="op">=</span> <span class="fu"><a href="../reference/make_designpattern.html">make_designpattern</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"No Phage"</span><span class="op">)</span>, rows <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">8</span>, cols <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, pattern <span class="op">=</span> <span class="st">"1"</span><span class="op">)</span>,</span>
<span>  <span class="st">"Phage"</span> <span class="op">=</span> <span class="fu"><a href="../reference/make_designpattern.html">make_designpattern</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Phage Added"</span><span class="op">)</span>, rows <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">8</span>, cols <span class="op">=</span> <span class="fl">7</span><span class="op">:</span><span class="fl">12</span>, pattern <span class="op">=</span> <span class="st">"1"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ex_dat_mrg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/merge_dfs.html">merge_dfs</a></span><span class="op">(</span><span class="va">example_tidydata</span>, <span class="va">example_design</span><span class="op">)</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(Well)`</span></span>
<span><span class="va">ex_dat_mrg</span><span class="op">$</span><span class="va">Well</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span><span class="op">$</span><span class="va">Well</span>,</span>
<span>         levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span>, each <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">12</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ex_dat_mrg</span><span class="op">$</span><span class="va">Time</span> <span class="op">&lt;-</span> <span class="va">ex_dat_mrg</span><span class="op">$</span><span class="va">Time</span><span class="op">/</span><span class="fl">3600</span> <span class="co">#Convert time to hours</span></span>
<span><span class="va">ex_dat_mrg</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>, <span class="va">Well</span>, <span class="va">Bacteria_strain</span>, <span class="va">Phage</span><span class="op">)</span>,</span>
<span>         deriv <span class="op">=</span> <span class="fu"><a href="../reference/calc_deriv.html">calc_deriv</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">Measurements</span><span class="op">)</span>,</span>
<span>         deriv_percap5 <span class="op">=</span> <span class="fu"><a href="../reference/calc_deriv.html">calc_deriv</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">Measurements</span>, </span>
<span>                                        percapita <span class="op">=</span> <span class="cn">TRUE</span>, blank <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                                        window_width_n <span class="op">=</span> <span class="fl">5</span>, trans_y <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span>,</span>
<span>         doub_time <span class="op">=</span> <span class="fu"><a href="../reference/doubling_time.html">doubling_time</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">deriv_percap5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sample_wells</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A1"</span>, <span class="st">"F1"</span>, <span class="st">"F10"</span>, <span class="st">"E11"</span><span class="op">)</span></span>
<span><span class="co"># Drop unneeded columns (optional, but makes things cleaner)</span></span>
<span><span class="va">ex_dat_mrg</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>,</span>
<span>                            <span class="va">Time</span>, <span class="va">Well</span>, <span class="va">Measurements</span>, <span class="va">Bacteria_strain</span>, <span class="va">Phage</span>,</span>
<span>                            <span class="va">deriv</span>, <span class="va">deriv_percap5</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="analyzing-data-with-summarize">Analyzing data with summarize<a class="anchor" aria-label="anchor" href="#analyzing-data-with-summarize"></a>
</h2>
<p>Ultimately, analyzing growth curves requires summarizing the entire
time series of data by some metric or metrics. gcplyr makes it easy to
calculate a number of metrics of interest, which I’ve grouped below into
categories:</p>
<div class="section level4">
<h4 id="growth">Growth<a class="anchor" aria-label="anchor" href="#growth"></a>
</h4>
<ul>
<li><a href="#init_dens">the initial density</a></li>
<li><a href="#lag">the lag time</a></li>
<li><a href="#dens_thresh">the time to reach some density</a></li>
<li><a href="#percap_thresh">the time to reach some growth rate</a></li>
<li><a href="#max_percap">the maximum per-capita growth rate
(i.e. minimum doubling time)</a></li>
</ul>
</div>
<div class="section level4">
<h4 id="saturation">Saturation<a class="anchor" aria-label="anchor" href="#saturation"></a>
</h4>
<ul>
<li><a href="#midpoint">the mid-point time or inflection point</a></li>
<li><a href="#maxdens">the maximum density (e.g. carrying
capacity)</a></li>
</ul>
</div>
<div class="section level4">
<h4 id="total-growth">Total growth<a class="anchor" aria-label="anchor" href="#total-growth"></a>
</h4>
<ul>
<li><a href="#auc">the area under the curve</a></li>
</ul>
</div>
<div class="section level4">
<h4 id="diauxic-growth">Diauxic growth<a class="anchor" aria-label="anchor" href="#diauxic-growth"></a>
</h4>
<ul>
<li><a href="#diauxie">the density and time when a diauxic shift
occurs</a></li>
<li><a href="#diauxic_percap">the maximum per-capita growth rate during
diauxie</a></li>
</ul>
</div>
<div class="section level4">
<h4 id="growth-with-antagonists-e-g--phages">Growth with antagonists (e.g. phages)<a class="anchor" aria-label="anchor" href="#growth-with-antagonists-e-g--phages"></a>
</h4>
<ul>
<li><a href="#peak_dens">the peak bacterial density before a decline
(e.g. from phage predation)</a></li>
<li><a href="#extin_time">the extinction time (e.g. from phage
predation)</a></li>
</ul>
<p>The following sections show how you can use <code>gcplyr</code>
functions to calculate these metrics.</p>
<p>But first, we need to familiarize ourselves with one more
<code>dplyr</code> function: <code>summarize</code>. Why? Because the
upcoming <code>gcplyr</code> analysis functions <em>must</em> be used
<em>within</em> <code><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">dplyr::summarize</a></code>. <strong>If you’re already
familiar with <code>dplyr</code>’s <code>summarize</code>, feel free to
skip the primer in the next section.</strong> If you’re not familiar
yet, don’t worry! Continue to the next section, where I provide a primer
that will teach you all you need to know on using <code>summarize</code>
with <code>gcplyr</code> functions.</p>
</div>
</div>
<div class="section level2">
<h2 id="another-brief-primer-on-dplyr-summarize">Another brief primer on dplyr: summarize<a class="anchor" aria-label="anchor" href="#another-brief-primer-on-dplyr-summarize"></a>
</h2>
<p>Here we’re going to focus on the <code>summarize</code> function from
<code>dplyr</code>, which <em>must</em> be used with the
<code>group_by</code> function we covered in our first primer: <a href="vignette(%2205_process%22)">A brief primer on dplyr</a>.
<code>summarize</code> carries out user-specified calculations on
<em>each</em> group in a grouped <code>data.frame</code> independently,
producing a new <code>data.frame</code> where each group is now just a
single row.</p>
<p>For growth curves, this means we will:</p>
<ol style="list-style-type: decimal">
<li>
<code>group_by</code> our data so that every well is a group</li>
<li>
<code>summarize</code> each well into one or several metrics</li>
</ol>
<p>As before, to use <code>group_by</code> we simply pass the
<code>data.frame</code> to be grouped, and the names of the columns we
want to group by. Since <code>summarize</code> will drop columns that
the data aren’t grouped by and that aren’t summarized, we will typically
want to list all of our design columns for <code>group_by</code>, along
with the plate name and well. Again, make sure you’re <em>not</em>
grouping by Time, Measurements, or anything else that varies
<em>within</em> a well, since if you do <code>dplyr</code> will group
timepoints within a well separately.</p>
<p>Then, we run <code>summarize</code>. <code>summarize</code> works
much like <code>mutate</code> did, where we specify:</p>
<ol style="list-style-type: decimal">
<li>the name of the variable we want results saved to</li>
<li>the function that calculates the summarized results</li>
</ol>
<p>Just like <code>mutate</code>, if we want additional summary metrics,
we simply add them to the summarize. However, unlike
<code>mutate</code>, <code>summarize</code> functions return just a
single value for each group.</p>
<p>As you’ll see throughout the rest of this article, we’ll be using
<code>group_by</code> and <code>summarize</code> to calculate our
metrics of interest. If you want to learn more, <code>dplyr</code> has
extensive documentation and examples of its own online, but this primer
and the coming example should be sufficient to analyze data with
<code>gcplyr</code>.</p>
</div>
<div class="section level2">
<h2 id="plotting-summarized-metrics">Plotting summarized metrics<a class="anchor" aria-label="anchor" href="#plotting-summarized-metrics"></a>
</h2>
<p>Once you’ve calculated your summarized metrics, you should plot them
on the original data to make sure everything matches what you expect. We
can plot summarized values right on top of our original data:</p>
<ul>
<li>density or rate metrics can be plotted as a horizontal line with
<code>geom_hline</code>
</li>
<li>time metrics can be plotted as a vertical line with
<code>geom_vline</code>
</li>
<li>pairs of metrics that correspond to both density/rate and time can
be plotted as a point with <code>geom_point</code>
</li>
</ul>
<p>You’ll see examples of these plots throughout this article.</p>
</div>
<div class="section level2">
<h2 id="init_dens">Initial density<a class="anchor" aria-label="anchor" href="#init_dens"></a>
</h2>
<p>If you want to identify the initial density of your bacteria, it will
often be sufficient to use <code>min_gc</code> (this works just like
<code>R</code>’s built-in <code>min</code>, but with better default
settings for growth curve analyses with <code>summarize</code>).</p>
<p>We can also save the time when this minimum occurs using the
<code>which_min_gc</code> function. <code>which_min_gc</code> returns
the <em>index</em> of the minimum value, so then we can get the
<code>Time</code> value at that index and save it to a column titled
<code>min_time</code>. (<code>which_min_gc</code> and
<code>extr_val</code> work just like <code>R</code>’s built-in
<code>which.min</code> and <code>[</code>, but with better default
settings for growth curve analyses with <code>summarize</code>)</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ex_dat_mrg_sum</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>, <span class="va">Bacteria_strain</span>, <span class="va">Phage</span>, <span class="va">Well</span><span class="op">)</span>,</span>
<span>            min_dens <span class="op">=</span> <span class="fu"><a href="../reference/MinMaxGC.html">min_gc</a></span><span class="op">(</span><span class="va">Measurements</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>            min_time <span class="op">=</span> <span class="fu"><a href="../reference/extr_val.html">extr_val</a></span><span class="op">(</span><span class="va">Time</span>, <span class="fu"><a href="../reference/WhichMinMaxGC.html">which_min_gc</a></span><span class="op">(</span><span class="va">Measurements</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; `summarise()` has grouped output by 'Bacteria_strain', 'Phage'. You can</span></span>
<span><span class="co">#&gt; override using the `.groups` argument.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ex_dat_mrg_sum</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 5</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   Bacteria_strain, Phage [6]</span></span></span>
<span><span class="co">#&gt;   Bacteria_strain Phage       Well  min_dens min_time</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Strain 1        No Phage    A1       0.002     0   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Strain 1        Phage Added A7       0.001     9.75</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Strain 10       No Phage    B4       0.002     0   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Strain 10       Phage Added B10      0.001    11   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Strain 11       No Phage    B5       0.002     0   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Strain 11       Phage Added B11      0.001     6</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>, <span class="va">Well</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sample_wells</span><span class="op">)</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">Measurements</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Well</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ex_dat_mrg_sum</span>, <span class="va">Well</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sample_wells</span><span class="op">)</span>, </span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">min_time</span>, y <span class="op">=</span> <span class="va">min_dens</span><span class="op">)</span>,</span>
<span>             size <span class="op">=</span> <span class="fl">2</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="gc06_analyze_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p>In some cases (e.g. growing with phages), bacteria may later drop to
a lower density than they started in the growth curve. In this case, we
want the first <em>local</em> minima of the Measurements data, rather
than the global minima:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ex_dat_mrg_sum</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>, <span class="va">Bacteria_strain</span>, <span class="va">Phage</span>, <span class="va">Well</span><span class="op">)</span>,</span>
<span>            min_dens <span class="op">=</span> <span class="fu"><a href="../reference/ExtremaFunctions.html">first_minima</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">Measurements</span>, x <span class="op">=</span> <span class="va">Time</span>, return <span class="op">=</span> <span class="st">"y"</span><span class="op">)</span>,</span>
<span>            min_time <span class="op">=</span> <span class="fu"><a href="../reference/ExtremaFunctions.html">first_minima</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">Measurements</span>, x <span class="op">=</span> <span class="va">Time</span>, return <span class="op">=</span> <span class="st">"x"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; `summarise()` has grouped output by 'Bacteria_strain', 'Phage'. You can</span></span>
<span><span class="co">#&gt; override using the `.groups` argument.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ex_dat_mrg_sum</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 5</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   Bacteria_strain, Phage [6]</span></span></span>
<span><span class="co">#&gt;   Bacteria_strain Phage       Well  min_dens min_time</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Strain 1        No Phage    A1       0.002        0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Strain 1        Phage Added A7       0.002        0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Strain 10       No Phage    B4       0.002        0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Strain 10       Phage Added B10      0.002        0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Strain 11       No Phage    B5       0.002        0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Strain 11       Phage Added B11      0.002        0</span></span></code></pre></div>
<p>Note that you can tune the sensitivity of <code>first_minima</code>
to different heights and widths of peaks and valleys using the
<code>window_width</code>, <code>window_width_n</code>, and
<code>window_height</code> arguments. You should check that
<code>first_minima</code> is working with your data by plotting it,
although the default sensitivity works much of the time.</p>
</div>
<div class="section level2">
<h2 id="lag">Lag time<a class="anchor" aria-label="anchor" href="#lag"></a>
</h2>
<p>Bacteria often have a period of time before they reach their maximum
growth rate. If you would like to quantify this lag time, you can use
the <code>lag_time</code> function. <code>lag_time</code> needs the x
and y values, as well as the (per-capita) derivative. It will find the
maximum derivative, then project the tangent line with that slope back
until it crosses the starting density.</p>
<p>Below, I calculate lag time. So that you can see a visualization of
what this tangent-line calculation does, I also calculate the
<code>max_percap</code>, <code>max_percap_time</code>,
<code>max_percap_dens</code>, and <code>min_dens</code>, but you don’t
have to do that.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ex_dat_mrg_sum</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>, <span class="va">Bacteria_strain</span>, <span class="va">Phage</span>, <span class="va">Well</span><span class="op">)</span>,</span>
<span>            lag_time <span class="op">=</span> <span class="fu"><a href="../reference/lag_time.html">lag_time</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">Measurements</span>, x <span class="op">=</span> <span class="va">Time</span>, </span>
<span>                                deriv <span class="op">=</span> <span class="va">deriv_percap5</span><span class="op">)</span>,</span>
<span>            max_percap <span class="op">=</span> <span class="fu"><a href="../reference/MinMaxGC.html">max_gc</a></span><span class="op">(</span><span class="va">deriv_percap5</span><span class="op">)</span>,</span>
<span>            max_percap_time <span class="op">=</span> <span class="va">Time</span><span class="op">[</span><span class="fu"><a href="../reference/WhichMinMaxGC.html">which_max_gc</a></span><span class="op">(</span><span class="va">deriv_percap5</span><span class="op">)</span><span class="op">]</span>,</span>
<span>            max_percap_dens <span class="op">=</span> <span class="va">Measurements</span><span class="op">[</span><span class="fu"><a href="../reference/WhichMinMaxGC.html">which_max_gc</a></span><span class="op">(</span><span class="va">deriv_percap5</span><span class="op">)</span><span class="op">]</span>,</span>
<span>            min_dens <span class="op">=</span> <span class="fu"><a href="../reference/MinMaxGC.html">min_gc</a></span><span class="op">(</span><span class="va">Measurements</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; `summarise()` has grouped output by 'Bacteria_strain', 'Phage'. You can</span></span>
<span><span class="co">#&gt; override using the `.groups` argument.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ex_dat_mrg_sum</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 8</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   Bacteria_strain, Phage [6]</span></span></span>
<span><span class="co">#&gt;   Bacteria_strain Phage       Well  lag_time max_percap max_percap_time</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Strain 1        No Phage    A1        2.18       1.03            4.25</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Strain 1        Phage Added A7        1.51       1.03            4.25</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Strain 10       No Phage    B4        1.78       1.59            3.5 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Strain 10       Phage Added B10       1.34       1.59            3.5 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Strain 11       No Phage    B5        1.67       1.65            3.5 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Strain 11       Phage Added B11       1.24       1.65            3.5 </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 2 more variables: max_percap_dens &lt;dbl&gt;, min_dens &lt;dbl&gt;</span></span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>, <span class="va">Well</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sample_wells</span><span class="op">)</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">Measurements</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Well</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ex_dat_mrg_sum</span>, <span class="va">Well</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sample_wells</span><span class="op">)</span>,</span>
<span>              color <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>              <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>slope <span class="op">=</span> <span class="va">max_percap</span>,</span>
<span>                  intercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">max_percap_dens</span><span class="op">)</span> <span class="op">-</span> <span class="va">max_percap</span><span class="op">*</span><span class="va">max_percap_time</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ex_dat_mrg_sum</span>, <span class="va">Well</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sample_wells</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">lag_time</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ex_dat_mrg_sum</span>, <span class="va">Well</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sample_wells</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">min_dens</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="gc06_analyze_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>Notice how in some of the wells the minimum density value isn’t the
<em>initial</em> density? We can fix that by overriding the default
minimum density calculation with <code>first_minima</code> via the
<code>y0</code> argument of <code>lag_time</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ex_dat_mrg_sum</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>, <span class="va">Bacteria_strain</span>, <span class="va">Phage</span>, <span class="va">Well</span><span class="op">)</span>,</span>
<span>            min_dens <span class="op">=</span> <span class="fu"><a href="../reference/ExtremaFunctions.html">first_minima</a></span><span class="op">(</span><span class="va">Measurements</span>, return <span class="op">=</span> <span class="st">"y"</span><span class="op">)</span>,</span>
<span>            lag_time <span class="op">=</span> <span class="fu"><a href="../reference/lag_time.html">lag_time</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">Measurements</span>, x <span class="op">=</span> <span class="va">Time</span>, </span>
<span>                                deriv <span class="op">=</span> <span class="va">deriv_percap5</span>, y0 <span class="op">=</span> <span class="va">min_dens</span><span class="op">)</span>,</span>
<span>            max_percap <span class="op">=</span> <span class="fu"><a href="../reference/MinMaxGC.html">max_gc</a></span><span class="op">(</span><span class="va">deriv_percap5</span><span class="op">)</span>,</span>
<span>            max_percap_time <span class="op">=</span> <span class="va">Time</span><span class="op">[</span><span class="fu"><a href="../reference/WhichMinMaxGC.html">which_max_gc</a></span><span class="op">(</span><span class="va">deriv_percap5</span><span class="op">)</span><span class="op">]</span>,</span>
<span>            max_percap_dens <span class="op">=</span> <span class="va">Measurements</span><span class="op">[</span><span class="fu"><a href="../reference/WhichMinMaxGC.html">which_max_gc</a></span><span class="op">(</span><span class="va">deriv_percap5</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; `summarise()` has grouped output by 'Bacteria_strain', 'Phage'. You can</span></span>
<span><span class="co">#&gt; override using the `.groups` argument.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ex_dat_mrg_sum</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 8</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   Bacteria_strain, Phage [6]</span></span></span>
<span><span class="co">#&gt;   Bacteria_strain Phage       Well  min_dens lag_time max_percap max_percap_time</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Strain 1        No Phage    A1       0.002     2.18       1.03            4.25</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Strain 1        Phage Added A7       0.002     2.18       1.03            4.25</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Strain 10       No Phage    B4       0.002     1.78       1.59            3.5 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Strain 10       Phage Added B10      0.002     1.78       1.59            3.5 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Strain 11       No Phage    B5       0.002     1.67       1.65            3.5 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Strain 11       Phage Added B11      0.002     1.67       1.65            3.5 </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: max_percap_dens &lt;dbl&gt;</span></span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>, <span class="va">Well</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sample_wells</span><span class="op">)</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">Measurements</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Well</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ex_dat_mrg_sum</span>, <span class="va">Well</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sample_wells</span><span class="op">)</span>,</span>
<span>              color <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>              <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>slope <span class="op">=</span> <span class="va">max_percap</span>,</span>
<span>                  intercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">max_percap_dens</span><span class="op">)</span> <span class="op">-</span> <span class="va">max_percap</span><span class="op">*</span><span class="va">max_percap_time</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ex_dat_mrg_sum</span>, <span class="va">Well</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sample_wells</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">lag_time</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ex_dat_mrg_sum</span>, <span class="va">Well</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sample_wells</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">min_dens</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="gc06_analyze_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="dens_thresh">Time to reach threshold density<a class="anchor" aria-label="anchor" href="#dens_thresh"></a>
</h2>
<p>If you want to quantify how long it takes bacteria to reach some
threshold density, you can use the <code>first_above</code> function. In
this example, we’ll use a Measurements value of 0.1 as our
threshold.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ex_dat_mrg_sum</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>, <span class="va">Bacteria_strain</span>, <span class="va">Phage</span>, <span class="va">Well</span><span class="op">)</span>,</span>
<span>            above_01 <span class="op">=</span> <span class="fu"><a href="../reference/ThresholdFunctions.html">first_above</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">Measurements</span>, x <span class="op">=</span> <span class="va">Time</span>, </span>
<span>                                   threshold <span class="op">=</span> <span class="fl">0.1</span>, return <span class="op">=</span> <span class="st">"x"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; `summarise()` has grouped output by 'Bacteria_strain', 'Phage'. You can</span></span>
<span><span class="co">#&gt; override using the `.groups` argument.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ex_dat_mrg_sum</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 4</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   Bacteria_strain, Phage [6]</span></span></span>
<span><span class="co">#&gt;   Bacteria_strain Phage       Well  above_01</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Strain 1        No Phage    A1        6.09</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Strain 1        Phage Added A7        6.09</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Strain 10       No Phage    B4        4.25</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Strain 10       Phage Added B10       4.25</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Strain 11       No Phage    B5        4.04</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Strain 11       Phage Added B11       4.04</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>, <span class="va">Well</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sample_wells</span><span class="op">)</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">Measurements</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Well</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ex_dat_mrg_sum</span>, <span class="va">Well</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sample_wells</span><span class="op">)</span>, </span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">above_01</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="gc06_analyze_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="percap_thresh">Time to reach threshold growth rate<a class="anchor" aria-label="anchor" href="#percap_thresh"></a>
</h2>
<p>If you want to quantify how long it takes bacteria to reach some
threshold per-capita growth rate, you can use the
<code>first_above</code> function. In this example, we’ll use a
per-capita derivative of 1 as our threshold.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ex_dat_mrg_sum</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>, <span class="va">Bacteria_strain</span>, <span class="va">Phage</span>, <span class="va">Well</span><span class="op">)</span>,</span>
<span>            percap_above_1 <span class="op">=</span> <span class="fu"><a href="../reference/ThresholdFunctions.html">first_above</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">deriv_percap5</span>, x <span class="op">=</span> <span class="va">Time</span>, </span>
<span>                                   threshold <span class="op">=</span> <span class="fl">1</span>, return <span class="op">=</span> <span class="st">"x"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; `summarise()` has grouped output by 'Bacteria_strain', 'Phage'. You can</span></span>
<span><span class="co">#&gt; override using the `.groups` argument.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ex_dat_mrg_sum</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 4</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   Bacteria_strain, Phage [6]</span></span></span>
<span><span class="co">#&gt;   Bacteria_strain Phage       Well  percap_above_1</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Strain 1        No Phage    A1              3.95</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Strain 1        Phage Added A7              3.95</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Strain 10       No Phage    B4              2.28</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Strain 10       Phage Added B10             2.28</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Strain 11       No Phage    B5              2.11</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Strain 11       Phage Added B11             2.11</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>, <span class="va">Well</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sample_wells</span><span class="op">)</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">deriv_percap5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Well</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ex_dat_mrg_sum</span>, <span class="va">Well</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sample_wells</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">percap_above_1</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 4 rows containing missing values (`geom_line()`).</span></span>
<span><span class="co">#&gt; Warning: Removed 2 rows containing missing values (`geom_vline()`).</span></span></code></pre></div>
<p><img src="gc06_analyze_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="max_percap">Maximum growth rate and minimum doubling time<a class="anchor" aria-label="anchor" href="#max_percap"></a>
</h2>
<p>If you want to calculate the bacterial maximum growth rate (i.e. the
minimum doubling time), it will often be sufficient to use
<code>max_gc</code> on the per-capita derivatives we calculated in
<code><a href="../articles/gc05_process.html">vignette("gc05_process")</a></code>. (<code>max_gc</code> works just
like <code>R</code>’s built-in <code>max</code>, but with better default
settings for growth curve analyses with <code>summarize</code>).</p>
<p>We can also save the time when this maximum occurs using the
<code>which_max_gc</code> function. <code>which_max_gc</code> returns
the <em>index</em> of the maximum value, so then we can get the
<code>Time</code> value at that index and save it to a column titled
<code>max_percap_time</code>. (<code>which_max_gc</code> and
<code>extr_val</code> work just like <code>R</code>’s built-in
<code>which.max</code> and <code>[</code>, but with better default
settings for growth curve analyses with <code>summarize</code>)</p>
<p>If you would like the equivalent minimum doubling time, you can
simply calculate the maximum growth rate as above and then convert that
into the equivalent minimum doubling time using the
<code>doubling_time</code> function.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ex_dat_mrg_sum</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>, <span class="va">Bacteria_strain</span>, <span class="va">Phage</span>, <span class="va">Well</span><span class="op">)</span>,</span>
<span>            max_percap <span class="op">=</span> <span class="fu"><a href="../reference/MinMaxGC.html">max_gc</a></span><span class="op">(</span><span class="va">deriv_percap5</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>            max_percap_time <span class="op">=</span> <span class="fu"><a href="../reference/extr_val.html">extr_val</a></span><span class="op">(</span><span class="va">Time</span>, <span class="fu"><a href="../reference/WhichMinMaxGC.html">which_max_gc</a></span><span class="op">(</span><span class="va">deriv_percap5</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            doub_time <span class="op">=</span> <span class="fu"><a href="../reference/doubling_time.html">doubling_time</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">max_percap</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; `summarise()` has grouped output by 'Bacteria_strain', 'Phage'. You can</span></span>
<span><span class="co">#&gt; override using the `.groups` argument.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ex_dat_mrg_sum</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 6</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   Bacteria_strain, Phage [6]</span></span></span>
<span><span class="co">#&gt;   Bacteria_strain Phage       Well  max_percap max_percap_time doub_time</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Strain 1        No Phage    A1          1.03            4.25     0.670</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Strain 1        Phage Added A7          1.03            4.25     0.670</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Strain 10       No Phage    B4          1.59            3.5      0.436</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Strain 10       Phage Added B10         1.59            3.5      0.436</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Strain 11       No Phage    B5          1.65            3.5      0.421</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Strain 11       Phage Added B11         1.65            3.5      0.421</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>, <span class="va">Well</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sample_wells</span><span class="op">)</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">deriv_percap5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Well</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ex_dat_mrg_sum</span>, <span class="va">Well</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sample_wells</span><span class="op">)</span>, </span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">max_percap_time</span>, y <span class="op">=</span> <span class="va">max_percap</span><span class="op">)</span>,</span>
<span>             size <span class="op">=</span> <span class="fl">2</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 4 rows containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="gc06_analyze_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="midpoint">Mid-point time or inflection point<a class="anchor" aria-label="anchor" href="#midpoint"></a>
</h2>
<p>If you want to find the mid-point or inflection point of bacterial
growth, there are two different approaches:</p>
<ol style="list-style-type: decimal">
<li>Mid-point: find the point when the density first reaches half the
maximum density.</li>
<li>Inflection point: find the point when the derivative is at a
maximum.</li>
</ol>
<p>In growth curve analysis approaches using fitting of a symmetric
function (e.g. when other <code>R</code> packages fit a logistic
function to data), these two points will be equivalent. However, since
<code>gcplyr</code> does model-free analyses, we do not assume symmetry,
and so the points may be very similar or very different.</p>
<p>For the mid-point, we use the <code>first_above</code> function, with
the threshold equal to the maximum bacterial density divided by 2. For
the inflection point, we find the time when the <code>deriv</code> was
at a maximum using <code>which_max_gc</code> (<code>which_max_gc</code>
and <code>extr_val</code> work just like <code>R</code>’s built-in
<code>which.max</code> and <code>[</code>, but with better default
settings for growth curve analyses with <code>summarize</code>).</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ex_dat_mrg_sum</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>, <span class="va">Bacteria_strain</span>, <span class="va">Phage</span>, <span class="va">Well</span><span class="op">)</span>,</span>
<span>            mid_point <span class="op">=</span> <span class="fu"><a href="../reference/ThresholdFunctions.html">first_above</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">Measurements</span>, x <span class="op">=</span> <span class="va">Time</span>, return <span class="op">=</span> <span class="st">"x"</span>,</span>
<span>                                    threshold <span class="op">=</span> <span class="fu"><a href="../reference/MinMaxGC.html">max_gc</a></span><span class="op">(</span><span class="va">Measurements</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>            infl_point <span class="op">=</span> <span class="fu"><a href="../reference/extr_val.html">extr_val</a></span><span class="op">(</span><span class="va">Time</span>, <span class="fu"><a href="../reference/WhichMinMaxGC.html">which_max_gc</a></span><span class="op">(</span><span class="va">deriv</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; `summarise()` has grouped output by 'Bacteria_strain', 'Phage'. You can</span></span>
<span><span class="co">#&gt; override using the `.groups` argument.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ex_dat_mrg_sum</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 5</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   Bacteria_strain, Phage [6]</span></span></span>
<span><span class="co">#&gt;   Bacteria_strain Phage       Well  mid_point infl_point</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Strain 1        No Phage    A1         9.15       8.25</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Strain 1        Phage Added A7         7.29       8.25</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Strain 10       No Phage    B4         6.06       5.5 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Strain 10       Phage Added B10        5.67       5.5 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Strain 11       No Phage    B5         5.71       5   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Strain 11       Phage Added B11       16.7        5</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>, <span class="va">Well</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sample_wells</span><span class="op">)</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">Measurements</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Well</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ex_dat_mrg_sum</span>, <span class="va">Well</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sample_wells</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">mid_point</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ex_dat_mrg_sum</span>, <span class="va">Well</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sample_wells</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">infl_point</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span>, color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span></code></pre></div>
<p><img src="gc06_analyze_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="maxdens">Maximum density<a class="anchor" aria-label="anchor" href="#maxdens"></a>
</h2>
<p>The maximum bacterial density can be a measure of bacterial growth
yield/efficiency. If your bacteria plateau in density, the maximum
density can also be a measure of bacterial carrying capacity. If you
want to quantify the maximum bacterial density, we can use
<code>max_gc</code> to get the global maxima of
<code>Measurements</code> (<code>max_gc</code>,
<code>which_max_gc</code>, and <code>extr_val</code> work just like
<code>R</code>’s built-in <code>max</code>, <code>which.max</code>, and
<code>[</code>, but with better default settings for growth curve
analyses with <code>summarize</code>).</p>
<p>See <a href="#peak_dens">Peak bacterial density</a> for identifying
<em>local</em> maxima of <code>Measurements</code> (e.g. if you wanted
the first peak in Well E11 shown below).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ex_dat_mrg_sum</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>, <span class="va">Bacteria_strain</span>, <span class="va">Phage</span>, <span class="va">Well</span><span class="op">)</span>,</span>
<span>            max_dens <span class="op">=</span> <span class="fu"><a href="../reference/MinMaxGC.html">max_gc</a></span><span class="op">(</span><span class="va">Measurements</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>            max_time <span class="op">=</span> <span class="fu"><a href="../reference/extr_val.html">extr_val</a></span><span class="op">(</span><span class="va">Time</span>, <span class="fu"><a href="../reference/WhichMinMaxGC.html">which_max_gc</a></span><span class="op">(</span><span class="va">Measurements</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; `summarise()` has grouped output by 'Bacteria_strain', 'Phage'. You can</span></span>
<span><span class="co">#&gt; override using the `.groups` argument.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ex_dat_mrg_sum</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 5</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   Bacteria_strain, Phage [6]</span></span></span>
<span><span class="co">#&gt;   Bacteria_strain Phage       Well  max_dens max_time</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Strain 1        No Phage    A1       1.18     24   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Strain 1        Phage Added A7       0.499     8.75</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Strain 10       No Phage    B4       1.21     23.8 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Strain 10       Phage Added B10      0.962     8.5 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Strain 11       No Phage    B5       1.21     19.5 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Strain 11       Phage Added B11      1.03     24</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>, <span class="va">Well</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sample_wells</span><span class="op">)</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">Measurements</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Well</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ex_dat_mrg_sum</span>, <span class="va">Well</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sample_wells</span><span class="op">)</span>, </span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">max_time</span>, y <span class="op">=</span> <span class="va">max_dens</span><span class="op">)</span>,</span>
<span>             size <span class="op">=</span> <span class="fl">2</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="gc06_analyze_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="auc">Area under the curve<a class="anchor" aria-label="anchor" href="#auc"></a>
</h2>
<p>The area under the curve is a common metric of total bacterial
growth, for instance in the presence of antagonists like antibiotics or
phages. If you want to calculate the area under the curve, you can use
the <code>gcplyr</code> function <code>auc</code>. Simply specify Time
as the x and Measurements as the y data whose area-under-the-curve you
want to calculate.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ex_dat_mrg_sum</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>, <span class="va">Bacteria_strain</span>, <span class="va">Phage</span>, <span class="va">Well</span><span class="op">)</span>,</span>
<span>            auc <span class="op">=</span> <span class="fu"><a href="../reference/auc.html">auc</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">Measurements</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; `summarise()` has grouped output by 'Bacteria_strain', 'Phage'. You can</span></span>
<span><span class="co">#&gt; override using the `.groups` argument.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ex_dat_mrg_sum</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 4</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   Bacteria_strain, Phage [6]</span></span></span>
<span><span class="co">#&gt;   Bacteria_strain Phage       Well    auc</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Strain 1        No Phage    A1    15.9 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Strain 1        Phage Added A7     1.07</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Strain 10       No Phage    B4    20.4 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Strain 10       Phage Added B10    6.15</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Strain 11       No Phage    B5    20.9 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Strain 11       Phage Added B11    7.77</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="diauxie">Diauxic shifts<a class="anchor" aria-label="anchor" href="#diauxie"></a>
</h2>
<p>Bacteria frequently exhibit a second, slower, burst of growth after
their first period of rapid growth. This is common in growth curves and
is called <em>diauxic growth</em>.</p>
<p>If we plot the data from some of our example data wells with no phage
added, we’ll see this pattern repeatedly:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nophage_wells</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A1"</span>, <span class="st">"A4"</span>, <span class="st">"E2"</span>, <span class="st">"F1"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>, <span class="va">Well</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">nophage_wells</span><span class="op">)</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">Measurements</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Well</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span></span></code></pre></div>
<p><img src="gc06_analyze_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<p>We can identify the time when bacteria switch from their first period
of rapid growth to their second period by finding a minima in the
derivative values. Specifically, we want to identify the second minima
(the first minima will occur at the beginning of the growth curve, when
bacteria are just starting to grow). Let’s look at some of the
derivative values to see this.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>, <span class="va">Well</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">nophage_wells</span><span class="op">)</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">deriv</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Well</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 1 row containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="gc06_analyze_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<p>We can use the <code>gcplyr</code> function
<code>find_local_extrema</code> to find that minima. Specify
<code>deriv</code> as the y data and <code>Time</code> as the x data,
and that we want <code>find_local_extrema</code> to <code>return</code>
the <code>x</code> values associated with local minima. It will return a
vector of those <code>x</code> values, and we’re going to save just the
second one.</p>
<p>At the same time, we’re also going to save the density where the
diauxic shift occurs. First, we’ll use <code>find_local_extrema</code>
again, but this time to save the <em>index</em> where the diauxic shift
occurs to a column titled <code>diauxie_idx</code>. Then, we can get the
<code>Measurements</code> value at that index. (Note that it wouldn’t
work to just specify <code>return = "y"</code>, because the
<code>y</code> values in this case are the <code>deriv</code> values).
(<code>extr_val</code> works just like <code>R</code>’s built-in
<code>[</code>, but with better default settings for growth curve
analyses with <code>summarize</code>).</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ex_dat_mrg_sum</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>, <span class="va">Bacteria_strain</span>, <span class="va">Phage</span>, <span class="va">Well</span><span class="op">)</span>,</span>
<span>    diauxie_time <span class="op">=</span> <span class="fu"><a href="../reference/ExtremaFunctions.html">find_local_extrema</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">deriv</span>, return <span class="op">=</span> <span class="st">"x"</span>,</span>
<span>                                   return_maxima <span class="op">=</span> <span class="cn">FALSE</span>, return_minima <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                   window_width_n <span class="op">=</span> <span class="fl">39</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>    diauxie_idx <span class="op">=</span> <span class="fu"><a href="../reference/ExtremaFunctions.html">find_local_extrema</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">deriv</span>, return <span class="op">=</span> <span class="st">"index"</span>,</span>
<span>                                   return_maxima <span class="op">=</span> <span class="cn">FALSE</span>, return_minima <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                   window_width_n <span class="op">=</span> <span class="fl">39</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>    diauxie_dens <span class="op">=</span> <span class="fu"><a href="../reference/extr_val.html">extr_val</a></span><span class="op">(</span><span class="va">Measurements</span>, <span class="va">diauxie_idx</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; `summarise()` has grouped output by 'Bacteria_strain', 'Phage'. You can</span></span>
<span><span class="co">#&gt; override using the `.groups` argument.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ex_dat_mrg_sum</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 6</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   Bacteria_strain, Phage [6]</span></span></span>
<span><span class="co">#&gt;   Bacteria_strain Phage       Well  diauxie_time diauxie_idx diauxie_dens</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Strain 1        No Phage    A1           16             65        1.01 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Strain 1        Phage Added A7            9             37        0.379</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Strain 10       No Phage    B4            9.75          40        0.999</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Strain 10       Phage Added B10           9.25          38        0.682</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Strain 11       No Phage    B5            9.5           39        1.01 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Strain 11       Phage Added B11           5.5           23        0.346</span></span>
<span></span>
<span><span class="co"># Plot data with a point at the moment of diauxic shift</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>, <span class="va">Well</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">nophage_wells</span><span class="op">)</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">Measurements</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Well</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ex_dat_mrg_sum</span>, <span class="va">Well</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">nophage_wells</span><span class="op">)</span>, </span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">diauxie_time</span>, y <span class="op">=</span> <span class="va">diauxie_dens</span><span class="op">)</span>,</span>
<span>             size <span class="op">=</span> <span class="fl">2</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="gc06_analyze_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<p>If needed, you can tune the sensitivity of
<code>find_local_extrema</code> to different heights and widths of peaks
and valleys using the <code>window_width</code>,
<code>window_width_n</code>, and <code>window_height</code>
arguments.</p>
</div>
<div class="section level2">
<h2 id="diauxic_percap">Growth rate during diauxie<a class="anchor" aria-label="anchor" href="#diauxic_percap"></a>
</h2>
<p>In the previous section we identified when bacteria shifted into
their second period of rapid growth (‘diauxic growth’). If you want to
find out what the peak per-capita growth rate was during that second
burst, we’ll have to use <code>max</code> on the subset of data after
the diauxic shift identified by <code>find_local_extrema</code></p>
<p>Just as we did in the previous section, we’ll use
<code>find_local_extrema</code> to save the time when the diauxic shift
occurs. Then, we’ll find the maximum of the per-capita derivative after
that shift occurs. Finally, we’ll find the time when that post-diauxie
maximum growth rate occurs. Note that we’re using <code>max_gc</code>
and <code>which_max_gc</code>, which work just like <code>R</code>’s
built-in <code>max</code> and <code>which.max</code>, but with better
default settings for growth curve analyses with
<code>summarize</code>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ex_dat_mrg_sum</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>, <span class="va">Bacteria_strain</span>, <span class="va">Phage</span>, <span class="va">Well</span><span class="op">)</span>,</span>
<span>    diauxie_time <span class="op">=</span> </span>
<span>      <span class="fu"><a href="../reference/ExtremaFunctions.html">find_local_extrema</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">deriv</span>, return <span class="op">=</span> <span class="st">"x"</span>,</span>
<span>                         return_maxima <span class="op">=</span> <span class="cn">FALSE</span>, return_minima <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                         window_width_n <span class="op">=</span> <span class="fl">39</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>    diauxie_percap <span class="op">=</span> <span class="fu"><a href="../reference/MinMaxGC.html">max_gc</a></span><span class="op">(</span><span class="va">deriv_percap5</span><span class="op">[</span><span class="va">Time</span> <span class="op">&gt;=</span> <span class="va">diauxie_time</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    diauxie_percap_time <span class="op">=</span> </span>
<span>      <span class="fu"><a href="../reference/extr_val.html">extr_val</a></span><span class="op">(</span><span class="va">Time</span><span class="op">[</span><span class="va">Time</span> <span class="op">&gt;=</span> <span class="va">diauxie_time</span><span class="op">]</span>,</span>
<span>               <span class="fu"><a href="../reference/WhichMinMaxGC.html">which_max_gc</a></span><span class="op">(</span><span class="va">deriv_percap5</span><span class="op">[</span><span class="va">Time</span> <span class="op">&gt;=</span> <span class="va">diauxie_time</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; `summarise()` has grouped output by 'Bacteria_strain', 'Phage'. You can</span></span>
<span><span class="co">#&gt; override using the `.groups` argument.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ex_dat_mrg_sum</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 6</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   Bacteria_strain, Phage [6]</span></span></span>
<span><span class="co">#&gt;   Bacteria_strain Phage    Well  diauxie_time diauxie_percap diauxie_percap_time</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Strain 1        No Phage A1           16            0.025<span style="text-decoration: underline;">7</span>                20  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Strain 1        Phage A… A7            9            0.832                 19.8</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Strain 10       No Phage B4            9.75         0.039<span style="text-decoration: underline;">8</span>                13.2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Strain 10       Phage A… B10           9.25         1.24                  17.8</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Strain 11       No Phage B5            9.5          0.043<span style="text-decoration: underline;">8</span>                12.2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Strain 11       Phage A… B11           5.5          1.43                  12.8</span></span>
<span></span>
<span><span class="co"># Plot data with a point at the moment of peak diauxic growth rate</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>, <span class="va">Well</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">nophage_wells</span><span class="op">)</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">deriv_percap5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Well</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ex_dat_mrg_sum</span>, <span class="va">Well</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">nophage_wells</span><span class="op">)</span>, </span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">diauxie_percap_time</span>, y <span class="op">=</span> <span class="va">diauxie_percap</span><span class="op">)</span>,</span>
<span>             size <span class="op">=</span> <span class="fl">2</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 4 rows containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="gc06_analyze_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="peak_dens">Peak bacterial density<a class="anchor" aria-label="anchor" href="#peak_dens"></a>
</h2>
<p><a href="#maxdens">We previously found the global maximum in
bacterial density</a> using the simple <code>max_gc</code> and
<code>which_max_gc</code> functions. The first <em>local</em> maxima can
also be of interest. This is especially true when bacteria are grown
with phages, where their first peak density can act as a proxy measure
for their susceptibility to the phage. If you’re interested in finding
the first local maxima in bacterial density, you can use the
<code>gcplyr</code> function <code>first_maxima</code>.</p>
<p><code>first_maxima</code> simply requires the <code>y</code> data you
want to identify the peak in. Specify <code>Measurements</code> as the y
data and <code>Time</code> as the x data, and that we want
<code>first_peak</code> to <code>return</code> the <code>x</code> and
<code>y</code> values associated with the peak. We’ll save those in
columns <code>first_maxima_x</code> and <code>first_maxima_y</code>,
respectively.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ex_dat_mrg_sum</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>, <span class="va">Bacteria_strain</span>, <span class="va">Phage</span>, <span class="va">Well</span><span class="op">)</span>,</span>
<span>            first_maxima_x <span class="op">=</span> <span class="fu"><a href="../reference/ExtremaFunctions.html">first_maxima</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">Measurements</span>, </span>
<span>                                          return <span class="op">=</span> <span class="st">"x"</span><span class="op">)</span>,</span>
<span>            first_maxima_y <span class="op">=</span> <span class="fu"><a href="../reference/ExtremaFunctions.html">first_maxima</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">Measurements</span>, </span>
<span>                                          return <span class="op">=</span> <span class="st">"y"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; `summarise()` has grouped output by 'Bacteria_strain', 'Phage'. You can</span></span>
<span><span class="co">#&gt; override using the `.groups` argument.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ex_dat_mrg_sum</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 5</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   Bacteria_strain, Phage [6]</span></span></span>
<span><span class="co">#&gt;   Bacteria_strain Phage       Well  first_maxima_x first_maxima_y</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Strain 1        No Phage    A1             24             1.18 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Strain 1        Phage Added A7              8.75          0.499</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Strain 10       No Phage    B4             19.8           1.21 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Strain 10       Phage Added B10             8.5           0.962</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Strain 11       No Phage    B5             19.5           1.21 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Strain 11       Phage Added B11             5.25          0.439</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>, <span class="va">Well</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sample_wells</span><span class="op">)</span>, </span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">Measurements</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Well</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ex_dat_mrg_sum</span>, <span class="va">Well</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sample_wells</span><span class="op">)</span>, </span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">first_maxima_x</span>, y <span class="op">=</span> <span class="va">first_maxima_y</span><span class="op">)</span>, </span>
<span>             color <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="gc06_analyze_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
<p>Note that you can tune the sensitivity of <code>first_maxima</code>
to different heights and widths of peaks and valleys using the
<code>window_width</code>, <code>window_width_n</code>, and
<code>window_height</code> arguments, although the defaults work much of
the time.</p>
</div>
<div class="section level2">
<h2 id="extin_time">Extinction time<a class="anchor" aria-label="anchor" href="#extin_time"></a>
</h2>
<p>The time when bacterial density falls below some threshold can also
be of interest. This is especially true when bacteria are grown with
phages, where this ‘extinction time’ can act as a proxy measure for
their susceptibility to the phage. If you’re interested in finding the
extinction time, you can use the <code>gcplyr</code> function
<code>first_below</code>. In this example, we’ll use a Measurements
value of 0.15 as our threshold.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ex_dat_mrg_sum</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>, <span class="va">Bacteria_strain</span>, <span class="va">Phage</span>, <span class="va">Well</span><span class="op">)</span>,</span>
<span>    extin_time <span class="op">=</span> <span class="fu"><a href="../reference/ThresholdFunctions.html">first_below</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">Measurements</span>, threshold <span class="op">=</span> <span class="fl">0.15</span>,</span>
<span>                             return <span class="op">=</span> <span class="st">"x"</span>, return_endpoints <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; `summarise()` has grouped output by 'Bacteria_strain', 'Phage'. You can</span></span>
<span><span class="co">#&gt; override using the `.groups` argument.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ex_dat_mrg_sum</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 4</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   Bacteria_strain, Phage [6]</span></span></span>
<span><span class="co">#&gt;   Bacteria_strain Phage       Well  extin_time</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Strain 1        No Phage    A1         <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Strain 1        Phage Added A7          9.18</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Strain 10       No Phage    B4         <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Strain 10       Phage Added B10         9.71</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Strain 11       No Phage    B5         <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Strain 11       Phage Added B11         5.64</span></span>
<span></span>
<span><span class="va">phage_wells</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A7"</span>, <span class="st">"B10"</span>, <span class="st">"F10"</span>, <span class="st">"H8"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ex_dat_mrg</span>, <span class="va">Well</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">phage_wells</span><span class="op">)</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">Measurements</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Well</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ex_dat_mrg_sum</span>, <span class="va">Well</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">phage_wells</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">extin_time</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="gc06_analyze_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="whats-next">What’s next?<a class="anchor" aria-label="anchor" href="#whats-next"></a>
</h2>
<p>Now that you’ve analyzed your data, you can read about approaches to
deal with noise in your growth curve data, or you can read some
concluding notes on best practices for running statistics, merging
growth curve analyses with other data, and additional resources for
analyzing growth curves.</p>
<ol style="list-style-type: decimal">
<li>Introduction: <code><a href="../articles/gc01_gcplyr.html">vignette("gc01_gcplyr")</a></code>
</li>
<li>Importing and transforming data:
<code><a href="../articles/gc02_import_transform.html">vignette("gc02_import_transform")</a></code>
</li>
<li>Incorporating design information:
<code><a href="../articles/gc03_incorporate_designs.html">vignette("gc03_incorporate_designs")</a></code>
</li>
<li>Pre-processing and plotting your data:
<code><a href="../articles/gc04_preprocess_plot.html">vignette("gc04_preprocess_plot")</a></code>
</li>
<li>Processing your data: <code><a href="../articles/gc05_process.html">vignette("gc05_process")</a></code>
</li>
<li>Analyzing your data: <code><a href="../articles/gc06_analyze.html">vignette("gc06_analyze")</a></code>
</li>
<li>
<strong>Dealing with noise:</strong>
<code><a href="../articles/gc07_noise.html">vignette("gc07_noise")</a></code>
</li>
<li>
<strong>Statistics, merging other data, and other
resources:</strong> <code><a href="../articles/gc08_conclusion.html">vignette("gc08_conclusion")</a></code>
</li>
<li>Working with multiple plates:
<code><a href="../articles/gc09_multiple_plates.html">vignette("gc09_multiple_plates")</a></code>
</li>
</ol>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://mikeblazanin.wordpress.com" class="external-link">Mike Blazanin</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
